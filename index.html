<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CareerPicker</title>

  <style>
    :root{
      --blue:#003b95;
      --blue2:#002f7a;
      --yellow:#febb02;
      --bg:#f5f7fb;
      --card:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --danger:#b42318;
      --shadow: 0 18px 40px rgba(0,0,0,.12);
      --softshadow: 0 10px 28px rgba(0,0,0,.08);
      --radius:18px;
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background:var(--bg);
    }
    .topbar{ background:var(--blue); color:#fff; padding:18px 20px; }
    .topbarInner{
      max-width:1100px; margin:0 auto; display:flex; align-items:center; justify-content:space-between; gap:16px;
    }
    .brand{ font-weight:900; letter-spacing:.2px; font-size:20px; }
    .topActions{ display:flex; align-items:center; gap:10px; font-weight:700; }
    .pill{
      border:1px solid rgba(255,255,255,.35);
      border-radius:999px;
      padding:8px 12px;
      background:transparent;
      color:#fff;
      font-weight:800;
      cursor:pointer;
    }
    .pill.white{ background:#fff; color:var(--blue); border-color:#fff; }

    .hero{
      background:linear-gradient(180deg,var(--blue) 0%, var(--blue2) 100%);
      color:#fff;
      padding:34px 20px 54px;
      position:relative;
    }
    .wrap{ max-width:1100px; margin:0 auto; }
    .hero h1{ margin:0; font-size:56px; letter-spacing:-.6px; line-height:1.02; }
    .hero p{ margin:10px 0 0; font-size:18px; color:rgba(255,255,255,.88); max-width:820px; }

    .searchbar{
      margin-top:18px;
      background:var(--yellow);
      border-radius:18px;
      padding:4px;
      box-shadow: var(--shadow);
      display:grid;
      grid-template-columns: 1.8fr .7fr .7fr .38fr;
      gap:4px;
      align-items:stretch;
    }
    .field{
      background:#fff;
      border-radius:14px;
      padding:12px 14px;
      display:flex;
      gap:10px;
      align-items:flex-start;
      min-height:74px;
      position:relative;
    }
    .icon{
      width:26px; height:26px; display:flex; align-items:center; justify-content:center;
      margin-top:6px; opacity:.75; font-weight:900;
    }
    .label{ font-size:14px; color:var(--muted); font-weight:800; margin-bottom:6px; }
    input, select{
      width:100%;
      border:none;
      outline:none;
      font-size:18px;
      font-weight:800;
      color:var(--text);
      background:transparent;
    }
    select{ padding-right:10px; cursor:pointer; }

    .btn{
      background:var(--blue);
      color:#fff;
      border:none;
      border-radius:14px;
      font-size:18px;
      font-weight:900;
      cursor:pointer;
    }
    .btn:disabled{ opacity:.6; cursor:not-allowed; }
    .btn:hover{ filter:brightness(1.05); }

    /* Booking-like dropdown */
    .comboPanel{
      position:absolute;
      left:8px;
      right:8px;
      top:82px;
      background:#fff;
      border-radius:16px;
      box-shadow: var(--softshadow);
      border: 1px solid rgba(0,0,0,.08);
      overflow:hidden;
      display:none;
      z-index:30;

      /* ‚úÖ FIX: force dark text inside dropdown (stops inheriting white from hero) */
      color: var(--text);
    }
    .panelHeader{
      padding:12px 14px 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      background:#fff;
      color:var(--text);
    }
    .panelTitle{ font-weight:1000; color:var(--text); }
    .panelHint{ font-weight:900; color:var(--muted); font-size:12px; }
    .panelList{
      max-height:340px;
      overflow:auto;
      border-top:1px solid rgba(0,0,0,.06);
      background:#fff;
      color:var(--text);
    }
    .panelItem{
      display:flex;
      gap:12px;
      padding:12px 14px;
      align-items:center;
      border-top:1px solid rgba(0,0,0,.06);
      cursor:pointer;
      background:#fff;
      color:var(--text);
    }
    .panelItem:first-child{ border-top:none; }
    .panelItem:hover{ background:#f6f7fb; }
    .panelItem.active{ background:#eef2ff; }
    .badge{
      width:36px; height:36px; border-radius:999px;
      background:#f3f4f6;
      display:flex; align-items:center; justify-content:center;
      font-weight:1000; opacity:.95; flex:0 0 auto;
      color: var(--text);
    }
    .pTitle{ font-weight:1000; font-size:16px; color:var(--text); }
    .pSub{ color:var(--muted); font-weight:850; margin-top:2px; font-size:13px; }

    .errorLine{
      margin-top:8px;
      font-weight:900;
      color: #fff;
      background: rgba(180, 35, 24, .28);
      border:1px solid rgba(255,255,255,.25);
      padding:10px 12px;
      border-radius:12px;
      display:none;
    }

    .section{ padding:26px 20px; }
    .cards4{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:16px;
      margin-top:18px;
    }
    .miniCard{
      background:#fff;
      border-radius:16px;
      border:1px solid rgba(0,0,0,.06);
      padding:16px;
      box-shadow: 0 8px 18px rgba(0,0,0,.06);
    }
    .miniTitle{ font-weight:1000; }
    .miniText{ margin-top:6px; color:var(--muted); font-weight:800; line-height:1.35; }

    .resultsTitle{ margin:10px 0 0; font-size:34px; font-weight:1000; letter-spacing:-.4px; }
    #results{ display:none; margin-top:12px; }

    .resultCard{
      background:#fff;
      border-radius:18px;
      border:1px solid rgba(0,0,0,.06);
      box-shadow: 0 12px 22px rgba(0,0,0,.06);
      padding:18px;
      margin:14px 0;
      cursor:pointer;
      transition: transform .08s ease;
    }
    .resultCard:hover{ transform: translateY(-1px); }
    .resultTop{ display:flex; align-items:flex-start; justify-content:space-between; gap:14px; }
    .resultName{ font-size:28px; font-weight:1000; letter-spacing:-.2px; margin:0; }
    .match{ font-weight:1000; color:var(--blue); font-size:22px; white-space:nowrap; margin-top:2px; }
    .tags{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
    .tag{
      border:1px solid rgba(0,0,0,.10);
      background:#f7f8fb;
      border-radius:999px;
      padding:7px 10px;
      font-weight:1000;
      color:#334155;
      font-size:14px;
    }
    .why{ margin-top:12px; color:#111827; font-weight:1000; }
    ul{ margin:8px 0 0 18px; color:#475569; font-weight:800; line-height:1.45; }

    .details{ display:none; margin-top:14px; padding-top:14px; border-top:1px solid rgba(0,0,0,.08); }
    .resultCard.expanded .details{ display:block; }

    .detailsGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px 16px;
      margin-top:10px;
    }
    .detailItem{
      background:#f7f8fb;
      border:1px solid rgba(0,0,0,.06);
      border-radius:14px;
      padding:12px 12px;
      font-size:14px;
    }
    .detailTitle{ font-weight:1000; margin-bottom:4px; color:#0f172a; }
    .detailText{ color:#334155; font-weight:850; line-height:1.35; }

    .moreRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-top:12px;
    }
    .hint{ opacity:.65; font-weight:1000; }
    .pillBtn{
      border:1px solid rgba(0,0,0,.12);
      background:#fff;
      padding:8px 10px;
      border-radius:999px;
      font-weight:1000;
      cursor:pointer;
    }
    .bottomRow{ display:flex; gap:10px; margin:16px 0 30px; }
    .secondaryBtn{
      background:#fff;
      border:1px solid rgba(0,0,0,.12);
      border-radius:14px;
      padding:12px 14px;
      font-weight:1000;
      cursor:pointer;
    }

    @media (max-width: 980px){
      .searchbar{ grid-template-columns: 1fr; }
      .cards4{ grid-template-columns: 1fr; }
      .hero h1{ font-size:42px; }
      .detailsGrid{ grid-template-columns: 1fr; }
      .comboPanel{ top:76px; }
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="topbarInner">
      <div class="brand">CareerPicker</div>
      <div class="topActions">
        <span style="opacity:.9;font-weight:900">AUD</span>
        <button class="pill">Register</button>
        <button class="pill white">Sign in</button>
      </div>
    </div>
  </div>

  <div class="hero">
    <div class="wrap">
      <h1>Find your next career</h1>
      <p>Pick a real job from the dropdown (type to search, scroll to browse). If it‚Äôs not in the list, Search won‚Äôt run.</p>

      <div class="searchbar">
        <div class="field" id="jobField">
          <div class="icon">üíº</div>
          <div style="width:100%">
            <div class="label">Choose a profession</div>
            <input id="jobInput" autocomplete="off" placeholder="Start typing‚Ä¶ (e.g. Lawyer, Software Engineer)" />
          </div>

          <div class="comboPanel" id="comboPanel">
            <div class="panelHeader">
              <div class="panelTitle" id="panelTitle">Professions</div>
              <div class="panelHint">Type to filter ‚Ä¢ Scroll ‚Ä¢ Enter to select</div>
            </div>
            <div class="panelList" id="panelList"></div>
          </div>
        </div>

        <div class="field">
          <div class="icon">üßæ</div>
          <div style="width:100%">
            <div class="label">ATAR / GPA</div>
            <input id="score" type="number" min="0" max="100" value="70" />
          </div>
        </div>

        <div class="field">
          <div class="icon">üí∞</div>
          <div style="width:100%">
            <div class="label">Salary goal</div>
            <select id="salary">
              <option value="low">Low</option>
              <option value="mid" selected>Medium</option>
              <option value="high">High</option>
            </select>
          </div>
        </div>

        <button class="btn" id="searchBtn" disabled>Search</button>
      </div>

      <div class="errorLine" id="errorLine">
        Please select a real job from the dropdown list (type to search, then click one).
      </div>
    </div>
  </div>

  <div class="section">
    <div class="wrap">
      <div class="cards4">
        <div class="miniCard">
          <div class="miniTitle">Real jobs only</div>
          <div class="miniText">Search only runs when you pick a job that exists in the list.</div>
        </div>
        <div class="miniCard">
          <div class="miniTitle">200+ professions</div>
          <div class="miniText">Bigger dropdown so most ‚Äúreal jobs‚Äù are already included.</div>
        </div>
        <div class="miniCard">
          <div class="miniTitle">More accurate shortlist</div>
          <div class="miniText">Shortlist is based on your exact profession + its best matching category.</div>
        </div>
        <div class="miniCard">
          <div class="miniTitle">Click for detail</div>
          <div class="miniText">Click any shortlist card to expand (day-to-day, entry, suggested jobs).</div>
        </div>
      </div>

      <div class="resultsTitle">Your shortlist</div>
      <div id="results"></div>

      <div class="bottomRow">
        <button class="secondaryBtn" id="resetBtn">Reset</button>
      </div>
    </div>
  </div>

  <script>
    const $ = (id) => document.getElementById(id);

    // ======================
    // Categories (clusters)
    // ======================
    const CATEGORIES = [
      {
        id: "law",
        name: "Law",
        tags: ["Lawyer","Paralegal","Legal Aid","Corporate Law"],
        why: [
          "Best if you like arguing a point with evidence, reading carefully, and writing clearly.",
          "You‚Äôll enjoy structured thinking: rules, exceptions, and how to apply them to real cases.",
          "Fits jobs where precision + responsibility matter."
        ],
        details: {
          subjects: "English, Legal Studies, Humanities, Business/Accounting",
          pathways: "Uni law (or related degree) ‚Üí clerkships/grad roles ‚Üí specialize (corporate/criminal/family/etc.)",
          dayToDay: "Reading cases/contracts, writing advice, meetings with clients, preparing documents, negotiating.",
          skills: "Writing, analysis, public speaking, attention to detail, ethics",
          entry: "Often university-based; strong English and consistent study habits help a lot.",
          next: "Debating club, Legal Studies, read case summaries, ask a lawyer what they do daily."
        }
      },
      {
        id: "policing",
        name: "Justice & Policing",
        tags: ["Police","Detective","Corrections","Forensics"],
        why: [
          "Good fit if you like structure, responsibility, and helping the public.",
          "Works best for people who stay calm under pressure and communicate well.",
          "Clear training routes for many roles."
        ],
        details: {
          subjects: "English, Psychology, Health/PE, Science",
          pathways: "Recruit training ‚Üí on-the-job experience ‚Üí specialist units (investigations/forensics/etc.)",
          dayToDay: "Responding to incidents, writing reports, interviewing, teamwork, problem-solving in real situations.",
          skills: "Communication, decision-making, resilience, teamwork, fitness",
          entry: "Fitness + background checks + training requirements vary by state.",
          next: "Check requirements, build fitness routine, volunteer/community work."
        }
      },
      {
        id: "government",
        name: "Policy & Government",
        tags: ["Policy","Compliance","Regulation","Public Service"],
        why: [
          "Great if you like systems, fairness, and improving how things work at scale.",
          "Strong match for people who like writing, research, and organized thinking.",
          "Many roles connect with law, business, and tech."
        ],
        details: {
          subjects: "English, Humanities, Economics, Legal Studies",
          pathways: "Uni/TAFE ‚Üí grad programs ‚Üí policy/ops/regulatory specializations",
          dayToDay: "Reading data, writing briefs, meeting stakeholders, improving processes, designing programs.",
          skills: "Research, writing, stakeholder management, systems thinking",
          entry: "A degree helps, but communication + structured thinking matters a lot.",
          next: "Practice writing short briefs, read role descriptions, join leadership roles."
        }
      },
      {
        id: "tech",
        name: "Technology & Software",
        tags: ["Software","Cyber","Data","Cloud"],
        why: [
          "Best if you like building things, solving puzzles, and learning fast.",
          "Strong match for logical thinkers who don‚Äôt mind trial-and-error.",
          "Many pathways: uni, TAFE, bootcamps, or self-taught with a portfolio."
        ],
        details: {
          subjects: "Maths, Digital Tech, Software Dev, Physics",
          pathways: "Uni/TAFE/self-taught ‚Üí portfolio ‚Üí junior role ‚Üí specialization",
          dayToDay: "Coding, debugging, code reviews, planning features, fixing issues, learning tools.",
          skills: "Coding, problem-solving, systems thinking, communication",
          entry: "Portfolio often matters more than perfect scores (depends on company).",
          next: "Build 3 projects, learn Git, pick JS or Python, make a portfolio page."
        }
      },
      {
        id: "health",
        name: "Healthcare",
        tags: ["Nursing","Allied Health","Medicine","Psychology"],
        why: [
          "Strong match if you like science + helping people directly.",
          "Best for people who can handle responsibility and teamwork.",
          "Clear training routes with placements."
        ],
        details: {
          subjects: "Biology, Chemistry, English, Maths",
          pathways: "Uni/TAFE ‚Üí placements ‚Üí registration ‚Üí specialization",
          dayToDay: "Assessing patients, planning care, documentation, communication, teamwork.",
          skills: "Empathy, accuracy, communication, stamina",
          entry: "Some pathways are competitive (medicine/psych) ‚Äî plan early.",
          next: "Check prerequisites, volunteer, choose sciences early."
        }
      },
      {
        id: "business",
        name: "Business & Management",
        tags: ["Business Analyst","Project","Marketing","Ops"],
        why: [
          "Good fit if you like planning, persuasion, and improving systems.",
          "Works well for people who enjoy teamwork and leading outcomes.",
          "Flexible across every industry."
        ],
        details: {
          subjects: "Business, Economics, Accounting, English",
          pathways: "Uni/TAFE ‚Üí grad roles ‚Üí specialize (BA/PM/Marketing/etc.)",
          dayToDay: "Meetings, planning, writing docs, analyzing numbers, coordinating people, improving processes.",
          skills: "Communication, analysis, planning, negotiation",
          entry: "Experience + results matter a lot (projects, internships, leadership roles).",
          next: "Run small projects, learn Excel, read case studies, practice presenting."
        }
      },
      {
        id: "creative",
        name: "Creative & Media",
        tags: ["UI/UX","Graphic","Video","Content"],
        why: [
          "Best if you like design, storytelling, and making things people enjoy using.",
          "Portfolio is the main ‚Äòproof‚Äô for many jobs here.",
          "Many paths: uni, short courses, self-built portfolio."
        ],
        details: {
          subjects: "Art, Media, English, Digital Tech",
          pathways: "Portfolio ‚Üí uni/short courses ‚Üí internships ‚Üí niche specialization",
          dayToDay: "Designing, editing, iterating, getting feedback, publishing work, improving quality.",
          skills: "Taste, iteration, storytelling, tools, feedback-handling",
          entry: "Portfolio usually beats grades (depends on role).",
          next: "Build a portfolio, redesign apps, learn Figma/Adobe, post work weekly."
        }
      },
      {
        id: "engineering",
        name: "Engineering",
        tags: ["Civil","Mechanical","Electrical","Mechatronics"],
        why: [
          "Strong match if you like maths + physics and building real systems.",
          "Great for problem-solvers who enjoy designing and testing.",
          "Clear pathways and strong demand in many areas."
        ],
        details: {
          subjects: "Maths Methods/Specialist, Physics, Chemistry",
          pathways: "Uni engineering ‚Üí placements ‚Üí graduate engineer ‚Üí chartered/specialist",
          dayToDay: "Designing, modeling, testing, safety checks, documentation, teamwork with stakeholders.",
          skills: "Maths, modeling, design, teamwork, safety mindset",
          entry: "Advanced maths helps a lot; placements/internships are huge.",
          next: "Choose advanced maths, do STEM projects, join robotics/engineering clubs."
        }
      },
      {
        id: "education",
        name: "Education",
        tags: ["Teacher","Tutor","Early Childhood","Support"],
        why: [
          "Best if you enjoy explaining and helping others improve.",
          "Good for patient, structured, people-focused personalities.",
          "Strong long-term stability and clear requirements."
        ],
        details: {
          subjects: "English + your strongest specialty subjects",
          pathways: "Uni teaching degree ‚Üí placements ‚Üí registration",
          dayToDay: "Planning lessons, teaching, marking, communicating with students/parents, improving learning.",
          skills: "Communication, patience, structure, creativity",
          entry: "Requires qualifications and placements.",
          next: "Volunteer tutoring, practice explaining, check teaching prerequisites."
        }
      }
    ];

    // Related category links (helps shortlist correlate)
    const RELATED = {
      law:        ["government","business","policing"],
      policing:   ["government","law","health"],
      government: ["law","business","tech"],
      tech:       ["engineering","business","creative"],
      health:     ["policing","education","government"],
      business:   ["government","tech","law"],
      creative:   ["tech","business","education"],
      engineering:["tech","business","government"],
      education:  ["health","government","creative"]
    };

    // ======================
    // 200+ professions (generated)
    // ======================
    function uniqueJobs(list){
      const seen = new Set();
      const out = [];
      for (const j of list){
        const key = j.title.toLowerCase();
        if (seen.has(key)) continue;
        seen.add(key);
        out.push(j);
      }
      return out;
    }

    function makeSub(categoryName, parts){
      return `${categoryName} ‚Ä¢ ${parts.join(" ‚Ä¢ ")}`;
    }

    function generateJobs(){
      const out = [];

      const add = (title, category, subParts) => {
        out.push({
          title,
          category,
          sub: makeSub(CATEGORIES.find(c=>c.id===category)?.name || "Career", subParts)
        });
      };

      // Law (30+)
      const lawCore = [
        "Lawyer","Solicitor","Barrister","Paralegal","Legal Assistant","Legal Secretary",
        "Compliance Officer","Contract Administrator","Contracts Manager","Legal Counsel",
        "Corporate Lawyer","Criminal Lawyer","Family Lawyer","Immigration Lawyer","Property Lawyer",
        "Litigation Lawyer","Employment Lawyer","IP Lawyer","Tax Lawyer","Environmental Lawyer",
        "Mediator","Conveyancer","Court Registrar","Notary Public","Claims Officer","Insurance Lawyer"
      ];
      lawCore.forEach(t => add(t, "law", ["documents","advice","rules"]));
      ["Privacy","Workplace","Corporate","Regulatory","Risk"].forEach(s => add(`${s} Compliance Analyst`, "law", ["compliance","audits","policy"]));

      // Justice & Policing (25+)
      const justice = [
        "Police Officer","Detective","Forensic Scientist","Forensic Analyst","Crime Scene Investigator",
        "Corrections Officer","Security Officer","Border Force Officer","Intelligence Analyst",
        "Emergency Dispatcher","Firefighter","Paramedic","Customs Officer","Protective Services Officer",
        "Child Protection Officer","Fraud Investigator","Private Investigator","Community Safety Officer"
      ];
      justice.forEach(t => add(t, "policing", ["public service","reports","teamwork"]));
      ["Cyber","Financial","Homicide","Missing Persons","Narcotics"].forEach(s => add(`${s} Investigator`, "policing", ["investigations","evidence","interviews"]));

      // Government / Policy (25+)
      const gov = [
        "Policy Officer","Policy Analyst","Program Officer","Program Manager","Project Officer",
        "Public Servant","Regulatory Officer","Compliance Officer (Government)","Grants Officer",
        "Procurement Officer","Urban Planner","Town Planner","Data Governance Officer",
        "Freedom of Information Officer","Community Engagement Officer","Case Manager (Government)",
        "Workplace Relations Officer","Inspector (Regulatory)","Licensing Officer","Environmental Health Officer"
      ];
      gov.forEach(t => add(t, "government", ["systems","briefs","stakeholders"]));
      ["Transport","Health","Education","Housing","Climate"].forEach(s => add(`${s} Policy Advisor`, "government", ["policy","analysis","impact"]));

      // Tech (60+)
      const techBases = [
        "Software Engineer","Frontend Developer","Backend Developer","Full Stack Developer","Web Developer",
        "Mobile App Developer","iOS Developer","Android Developer","Game Developer",
        "Data Analyst","Data Engineer","Data Scientist","Machine Learning Engineer","AI Engineer",
        "Cybersecurity Analyst","Security Engineer","Cloud Engineer","DevOps Engineer","Site Reliability Engineer",
        "QA Engineer","Test Automation Engineer","Product Analyst","Business Intelligence Analyst",
        "UX Engineer","Solutions Architect","Network Engineer","Systems Administrator"
      ];
      techBases.forEach(t => add(t, "tech", ["build","debug","ship"]));
      const techSpecs = ["Junior","Senior","Lead"];
      const techFocus = ["Cloud","Security","Data","Web","Mobile","AI"];
      techSpecs.forEach(level=>{
        techFocus.forEach(f=>{
          add(`${level} ${f} Engineer`, "tech", ["specialist","tools","delivery"]);
        });
      });
      ["Python","Java","JavaScript","C#","Go","Rust"].forEach(lang=>{
        add(`${lang} Developer`, "tech", ["coding","features","apps"]);
      });
      ["UI/UX","Product","Platform","Infrastructure"].forEach(area=>{
        add(`${area} Engineer`, "tech", ["systems","quality","scale"]);
      });

      // Engineering (30+)
      const eng = [
        "Civil Engineer","Structural Engineer","Mechanical Engineer","Electrical Engineer","Mechatronics Engineer",
        "Software Engineer (Embedded)","Biomedical Engineer","Chemical Engineer","Environmental Engineer",
        "Mining Engineer","Aerospace Engineer","Industrial Engineer","Robotics Engineer",
        "Architect","Surveyor","Quantity Surveyor","Draftsperson","CAD Technician","Geotechnical Engineer"
      ];
      eng.forEach(t => add(t, "engineering", ["design","test","safety"]));
      ["Junior","Senior","Graduate"].forEach(level=>{
        ["Civil","Mechanical","Electrical","Structural"].forEach(d=>{
          add(`${level} ${d} Engineer`, "engineering", ["projects","models","site"]);
        });
      });

      // Healthcare (30+)
      const health = [
        "Nurse","Registered Nurse","Enrolled Nurse","Doctor","General Practitioner","Surgeon",
        "Psychologist","Counsellor","Physiotherapist","Occupational Therapist","Speech Pathologist",
        "Pharmacist","Dentist","Dental Hygienist","Radiographer","Sonographer","Paramedic",
        "Dietitian","Optometrist","Pathologist","Medical Laboratory Scientist","Midwife"
      ];
      health.forEach(t => add(t, "health", ["care","science","teamwork"]));
      ["Emergency","ICU","Mental Health","Paediatric","Aged Care"].forEach(area=>{
        add(`${area} Nurse`, "health", ["patients","clinical","shift work"]);
      });

      // Business (35+)
      const biz = [
        "Business Analyst","Project Manager","Product Manager","Operations Manager","Marketing Specialist",
        "Digital Marketer","Accountant","Financial Analyst","Investment Analyst","Management Consultant",
        "HR Officer","Recruiter","Sales Representative","Account Manager","Customer Success Manager",
        "Supply Chain Analyst","Logistics Coordinator","Procurement Specialist","Brand Manager",
        "Entrepreneur","E-commerce Manager","Real Estate Agent","Office Manager","Executive Assistant"
      ];
      biz.forEach(t => add(t, "business", ["planning","people","results"]));
      ["Junior","Senior"].forEach(level=>{
        ["Business Analyst","Project Manager","Product Manager","Marketing Manager"].forEach(role=>{
          add(`${level} ${role}`, "business", ["ownership","delivery","growth"]);
        });
      });

      // Creative (25+)
      const creative = [
        "Graphic Designer","UI/UX Designer","Product Designer","Illustrator","Animator","3D Artist",
        "Video Editor","Photographer","Content Creator","Copywriter","Social Media Manager",
        "Creative Director","Motion Designer","Sound Designer","Game Artist","Brand Designer",
        "Film Producer","Journalist","Podcaster","Streamer"
      ];
      creative.forEach(t => add(t, "creative", ["design","story","portfolio"]));
      ["Junior","Senior"].forEach(level=>{
        ["Graphic Designer","UI/UX Designer","Video Editor","Content Designer"].forEach(role=>{
          add(`${level} ${role}`, "creative", ["quality","style","feedback"]);
        });
      });

      // Education (20+)
      const edu = [
        "Teacher (Primary)","Teacher (Secondary)","Early Childhood Educator","Tutor","Teacher Aide",
        "Special Education Teacher","School Counsellor","Education Support Officer","Librarian (School)",
        "Sports Coach","Music Teacher","Math Tutor","English Tutor","Science Tutor"
      ];
      edu.forEach(t => add(t, "education", ["learning","people","structure"]));
      ["VCE","Primary","Early Years"].forEach(stage=>{
        add(`${stage} Coordinator`, "education", ["coordination","students","planning"]);
      });

      return uniqueJobs(out).sort((a,b)=>a.title.localeCompare(b.title));
    }

    const JOBS = generateJobs(); // ‚úÖ usually 230‚Äì300+

    // ======================
    // UI State
    // ======================
    let selectedJob = null;
    let filteredJobs = [];
    let activeIndex = -1;

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function categoryIcon(cat){
      const map = {
        law:"‚öñÔ∏è", policing:"üöì", government:"üèõÔ∏è", tech:"üíª",
        engineering:"üõ†Ô∏è", health:"ü©∫", business:"üìà", creative:"üé®", education:"üìö"
      };
      return map[cat] || "üíº";
    }

    function getCategory(catId){
      return CATEGORIES.find(c => c.id === catId);
    }

    // ======================
    // Combobox dropdown logic
    // ======================
    function showPanel(){ $("comboPanel").style.display = "block"; }
    function hidePanel(){
      $("comboPanel").style.display = "none";
      activeIndex = -1;
      renderPanelList();
    }

    function setError(on){ $("errorLine").style.display = on ? "block" : "none"; }

    function setSelected(job){
      selectedJob = job;
      $("jobInput").value = job.title;
      $("searchBtn").disabled = false;
      setError(false);
      hidePanel();
    }

    function filterJobs(query){
      const q = (query || "").trim().toLowerCase();
      if (!q) return JOBS.slice(0, 250); // show a lot, but not too crazy
      return JOBS.filter(j => j.title.toLowerCase().includes(q) || (j.sub||"").toLowerCase().includes(q)).slice(0, 250);
    }

    function renderPanelList(){
      const list = $("panelList");
      list.innerHTML = "";

      const items = filteredJobs;

      if (!items.length){
        const empty = document.createElement("div");
        empty.className = "panelItem";
        empty.style.cursor = "default";
        empty.innerHTML = `
          <div class="badge">‚ùå</div>
          <div>
            <div class="pTitle">No match</div>
            <div class="pSub">Try a different spelling, or scroll the list.</div>
          </div>
        `;
        list.appendChild(empty);
        return;
      }

      items.forEach((job, idx) => {
        const div = document.createElement("div");
        div.className = "panelItem" + (idx === activeIndex ? " active" : "");
        div.innerHTML = `
          <div class="badge">${categoryIcon(job.category)}</div>
          <div>
            <div class="pTitle">${escapeHtml(job.title)}</div>
            <div class="pSub">${escapeHtml(getCategory(job.category)?.name || "")} ‚Ä¢ ${escapeHtml(job.sub || "")}</div>
          </div>
        `;
        div.addEventListener("mousedown", (e) => {
          e.preventDefault();
          setSelected(job);
        });
        list.appendChild(div);
      });
    }

    function ensureActiveVisible(){
      const list = $("panelList");
      const item = list.children[activeIndex];
      if (!item) return;

      const itemTop = item.offsetTop;
      const itemBottom = itemTop + item.offsetHeight;
      const viewTop = list.scrollTop;
      const viewBottom = viewTop + list.clientHeight;

      if (itemTop < viewTop) list.scrollTop = itemTop;
      else if (itemBottom > viewBottom) list.scrollTop = itemBottom - list.clientHeight;
    }

    function refreshPanel(){
      filteredJobs = filterJobs($("jobInput").value);
      renderPanelList();
    }

    function validateExactJob(){
      const val = $("jobInput").value.trim().toLowerCase();
      if (!val) return null;
      return JOBS.find(j => j.title.toLowerCase() === val) || null;
    }

    // ======================
    // Shortlist scoring (more correlated + deeper)
    // ======================
    function scoreCategory(catId, atar, salary, primaryCat){
      let s = 10;

      if (catId === primaryCat) s += 120;
      else if ((RELATED[primaryCat] || []).includes(catId)) s += 70;
      else s += 30;

      const g = Number(atar) || 0;

      // ATAR influence (simple but better)
      const competitive = ["law","health","engineering"];
      if (competitive.includes(catId)){
        s += (g >= 90 ? 18 : g >= 80 ? 12 : g >= 70 ? 6 : 2);
      } else {
        s += (g >= 80 ? 10 : g >= 70 ? 7 : 4);
      }

      // salary influence
      if (salary === "high"){
        if (["tech","engineering","law","business"].includes(catId)) s += 10;
        else s += 4;
      } else if (salary === "low"){
        if (["government","policing","education","health"].includes(catId)) s += 7;
      }

      return s;
    }

    function toPercent(rankIndex, topScore, score){
      const raw = Math.max(0, Math.min(100, Math.round((score / topScore) * 100)));
      if (rankIndex === 0) return Math.max(raw, 75);
      if (rankIndex === 1) return Math.min(Math.max(raw, 62), 90);
      if (rankIndex === 2) return Math.min(Math.max(raw, 55), 85);
      if (rankIndex === 3) return Math.min(Math.max(raw, 48), 78);
      return Math.min(Math.max(raw, 42), 72);
    }

    function sampleJobsForCategory(catId, excludeTitle){
      const matches = JOBS.filter(j => j.category === catId && j.title !== excludeTitle);
      // pick first 8 alphabetically (stable)
      return matches.slice(0, 8).map(j => j.title);
    }

    function renderResults(sorted, primaryJob){
      const results = $("results");
      results.style.display = "block";
      results.innerHTML = "";

      const top5 = sorted.slice(0,5);
      const topScore = top5[0].score;

      top5.forEach((item, idx) => {
        const cat = getCategory(item.catId);
        const pct = toPercent(idx, topScore, item.score);

        const suggested = sampleJobsForCategory(item.catId, primaryJob.title);
        const alsoLike = suggested.length ? suggested.slice(0,6) : [];

        const card = document.createElement("div");
        card.className = "resultCard";
        card.innerHTML = `
          <div class="resultTop">
            <div>
              <h3 class="resultName">${idx+1}. ${escapeHtml(cat.name)}</h3>
              <div class="tags">
                ${cat.tags.map(t => `<span class="tag">${escapeHtml(t)}</span>`).join("")}
              </div>
            </div>
            <div class="match">${pct}% match</div>
          </div>

          <div class="why">Why it fits:</div>
          <ul>
            <li><b>Your chosen profession:</b> ${escapeHtml(primaryJob.title)}</li>
            <li><b>Main match logic:</b> ${escapeHtml(cat.id === primaryJob.category ? "Same category as your job." : "Related to your job category.")}</li>
            ${cat.why.map(x => `<li>${escapeHtml(x)}</li>`).join("")}
          </ul>

          <div class="moreRow">
            <span class="hint">Click to expand</span>
            <button class="pillBtn" data-toggle-details>More details</button>
          </div>

          <div class="details">
            <div class="detailsGrid">
              <div class="detailItem">
                <div class="detailTitle">Day-to-day</div>
                <div class="detailText">${escapeHtml(cat.details.dayToDay)}</div>
              </div>
              <div class="detailItem">
                <div class="detailTitle">Entry / pathway</div>
                <div class="detailText">${escapeHtml(cat.details.pathways)}</div>
              </div>
              <div class="detailItem">
                <div class="detailTitle">Best subjects</div>
                <div class="detailText">${escapeHtml(cat.details.subjects)}</div>
              </div>
              <div class="detailItem">
                <div class="detailTitle">Key skills</div>
                <div class="detailText">${escapeHtml(cat.details.skills)}</div>
              </div>
              <div class="detailItem">
                <div class="detailTitle">Entry notes</div>
                <div class="detailText">${escapeHtml(cat.details.entry)}</div>
              </div>
              <div class="detailItem">
                <div class="detailTitle">Next steps (this week)</div>
                <div class="detailText">${escapeHtml(cat.details.next)}</div>
              </div>

              <div class="detailItem" style="grid-column:1/-1;">
                <div class="detailTitle">You might also like (real jobs)</div>
                <div class="detailText">
                  ${alsoLike.length ? alsoLike.map(x => `‚Ä¢ ${escapeHtml(x)}`).join("<br/>") : "No suggestions found."}
                </div>
              </div>
            </div>
          </div>
        `;
        results.appendChild(card);
      });

      results.scrollIntoView({ behavior:"smooth", block:"start" });
    }

    function runSearch(){
      const exact = validateExactJob();
      if (!exact){
        $("searchBtn").disabled = true;
        setError(true);
        $("results").style.display = "none";
        return;
      }

      selectedJob = exact;
      $("searchBtn").disabled = false;
      setError(false);

      const atar = $("score").value;
      const salary = $("salary").value;
      const primaryCat = selectedJob.category;

      const scored = CATEGORIES.map(c => ({
        catId: c.id,
        score: scoreCategory(c.id, atar, salary, primaryCat)
      })).sort((a,b) => b.score - a.score);

      renderResults(scored, selectedJob);
    }

    // ======================
    // Events
    // ======================
    $("jobInput").addEventListener("focus", () => {
      refreshPanel();
      showPanel();
    });

    $("jobInput").addEventListener("input", () => {
      const exact = validateExactJob();
      if (exact){
        selectedJob = exact;
        $("searchBtn").disabled = false;
        setError(false);
      } else {
        selectedJob = null;
        $("searchBtn").disabled = true;
      }
      refreshPanel();
      showPanel();
    });

    $("jobInput").addEventListener("keydown", (e) => {
      if ($("comboPanel").style.display !== "block") return;

      if (e.key === "ArrowDown"){
        e.preventDefault();
        if (!filteredJobs.length) return;
        activeIndex = Math.min(filteredJobs.length - 1, activeIndex + 1);
        renderPanelList();
        ensureActiveVisible();
      } else if (e.key === "ArrowUp"){
        e.preventDefault();
        if (!filteredJobs.length) return;
        activeIndex = Math.max(0, activeIndex - 1);
        renderPanelList();
        ensureActiveVisible();
      } else if (e.key === "Enter"){
        const pick = filteredJobs[activeIndex];
        if (pick){
          e.preventDefault();
          setSelected(pick);
        } else {
          const exact = validateExactJob();
          if (exact){
            e.preventDefault();
            setSelected(exact);
          }
        }
      } else if (e.key === "Escape"){
        hidePanel();
      }
    });

    document.addEventListener("mousedown", (e) => {
      const field = $("jobField");
      if (!field.contains(e.target)) hidePanel();
    });

    $("searchBtn").addEventListener("click", runSearch);

    $("resetBtn").addEventListener("click", () => {
      $("jobInput").value = "";
      $("score").value = 70;
      $("salary").value = "mid";
      selectedJob = null;
      $("searchBtn").disabled = true;
      setError(false);
      $("results").style.display = "none";
      $("results").innerHTML = "";
      window.scrollTo({ top: 0, behavior:"smooth" });
    });

    document.addEventListener("click", (e) => {
      const toggleBtn = e.target.closest("[data-toggle-details]");
      if (toggleBtn){
        e.preventDefault();
        const card = toggleBtn.closest(".resultCard");
        if (card) card.classList.toggle("expanded");
        return;
      }
      const card = e.target.closest(".resultCard");
      if (!card) return;
      if (e.target.closest("a, button, input, select, textarea")) return;
      card.classList.toggle("expanded");
    });

    // Initial list
    filteredJobs = filterJobs("");
    renderPanelList();
  </script>
</body>
</html>
