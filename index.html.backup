<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CareerPicker</title>
  <style>
    :root{
      --bg:#f3f6fb;
      --nav:#0a2b6a;
      --nav2:#0b3b95;
      --card:#ffffff;
      --muted:#6b7280;
      --text:#0b1220;

      --brand:#0b5cff;
      --brand2:#00a3ff;

      --accent:#ffb400;        /* booking-ish gold */
      --accent2:#ffcc4d;

      --shadow: 0 18px 60px rgba(9, 30, 66, .16);
      --shadow2: 0 10px 25px rgba(15, 23, 42, .10);

      --radius: 18px;
      --radius2: 14px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: var(--bg);
      color: var(--text);
    }

    /* Top bar */
    .topbar{
      height:64px;
      background: linear-gradient(90deg, rgba(7,33,80,.95), rgba(9,45,120,.95));
      color:#fff;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:0 20px;
      position:sticky;
      top:0;
      z-index:20;
      box-shadow: 0 6px 18px rgba(0,0,0,.14);
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:800;
      letter-spacing:.2px;
    }
    .dot{
      width:10px;height:10px;border-radius:50%;
      background: radial-gradient(circle at 30% 30%, var(--accent2), var(--accent));
      box-shadow: 0 0 0 3px rgba(255,204,77,.25);
    }
    .top-actions{
      display:flex; align-items:center; gap:10px;
      opacity:.95;
    }
    .pill{
      border:1px solid rgba(255,255,255,.25);
      color:#fff;
      background: rgba(255,255,255,.08);
      padding:8px 12px;
      border-radius:999px;
      font-weight:650;
      cursor:pointer;
      user-select:none;
    }
    .pill.primary{
      background: rgba(255,255,255,.95);
      color:#0b2b6a;
      border-color: transparent;
    }

    /* Hero */
    .hero{
      background:
        radial-gradient(1100px 420px at 25% 15%, rgba(0,163,255,.35), transparent 65%),
        radial-gradient(900px 380px at 75% 25%, rgba(255,180,0,.22), transparent 70%),
        linear-gradient(180deg, #06204f 0%, #0a3b95 70%, rgba(10,59,149,0) 100%);
      padding:44px 0 26px;
      position:relative;
      overflow:hidden;
    }
    .wrap{
      width:min(1120px, 92vw);
      margin:0 auto;
    }
    .hero h1{
      margin:0 0 10px;
      color:#fff;
      font-size: 52px;
      line-height:1.02;
      letter-spacing:-.8px;
    }
    .hero p{
      margin:0 0 16px;
      color:rgba(255,255,255,.82);
      font-size:18px;
      max-width: 900px;
    }

    /* Intent fork CTAs */
    .intentFork{
      margin: 24px 0 20px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }
    .intentCard{
      background: #fff;
      border: 2px solid #e5e7eb;
      border-radius: 18px;
      padding: 24px;
      cursor: pointer;
      box-shadow: 0 12px 35px rgba(0,0,0,.12);
      transition: all .15s ease;
      position: relative;
    }
    .intentCard:hover{
      transform: translateY(-2px);
      box-shadow: 0 18px 45px rgba(0,0,0,.18);
      border-color: #cbd5e1;
    }
    .intentCard.primary{
      background: linear-gradient(135deg, #fffbf0 0%, #fff9e6 100%);
      border-color: var(--accent);
      border-width: 3px;
    }
    .intentCard.primary:hover{
      border-color: #e6a200;
      box-shadow: 0 18px 45px rgba(255,180,0,.25);
    }
    .intentCard.selected{
      border-color: var(--brand);
      background: linear-gradient(135deg, #eef6ff 0%, #e0efff 100%);
    }
    .intentCard .emoji{
      font-size: 32px;
      margin-bottom: 12px;
      display: block;
    }
    .intentCard .intentTitle{
      font-size: 20px;
      font-weight: 950;
      letter-spacing: -.3px;
      margin: 0 0 8px;
      color: #0b1220;
      line-height: 1.2;
    }
    .intentCard .intentDesc{
      font-size: 14px;
      color: #64748b;
      font-weight: 750;
      margin: 0;
      line-height: 1.4;
    }
    .intentCard .badge-primary{
      position: absolute;
      top: 16px;
      right: 16px;
      background: var(--accent);
      color: #0b1220;
      font-size: 11px;
      font-weight: 950;
      padding: 5px 10px;
      border-radius: 999px;
      text-transform: uppercase;
      letter-spacing: .3px;
    }

    /* Search row */
    .searchRow{
      margin-top:18px;
      background: var(--accent);
      border-radius: 18px;
      padding:5px;
      box-shadow: 0 16px 45px rgba(0,0,0,.25);
    }
    .searchGrid{
      display:grid;
      grid-template-columns: 1.5fr .7fr .9fr .42fr;
      gap:5px;
    }
    .field{
      background:#fff;
      border-radius: 14px;
      padding:12px 14px;
      display:flex;
      gap:10px;
      align-items:flex-start;
      min-height:78px;
    }
    .icon{
      width:38px;height:38px;border-radius:12px;
      background: #f0f6ff;
      display:flex;align-items:center;justify-content:center;
      border:1px solid #e2e8f0;
      flex:0 0 auto;
      margin-top:2px;
    }
    .icon svg{opacity:.75}
    .field .label{
      font-size:13px;
      color: #334155;
      font-weight:800;
      letter-spacing:.15px;
      margin-bottom:2px;
    }
    .field .sub{
      font-size:13px;
      color: var(--muted);
      font-weight:600;
      margin-top:3px;
    }
    .field .value{
      font-size:20px;
      font-weight:900;
      letter-spacing:-.2px;
      margin-top:2px;
      color:#0b1220;
    }
    .field .value.muted{
      color:#0b1220;
      opacity:.65;
      font-weight:850;
    }
    .fieldcol{flex:1 1 auto; min-width:0;}
    .inputlike{
      width:100%;
      border:none;
      outline:none;
      background:transparent;
      font-size:20px;
      font-weight:900;
      color:#0b1220;
      padding:0;
      margin:0;
    }
    .inputlike::placeholder{color:rgba(11,18,32,.45); font-weight:850;}
    .smallrow{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
    }

    .cta{
      border:none;
      border-radius: 14px;
      background: linear-gradient(180deg, #083a93, #062b6f);
      color:#fff;
      cursor:pointer;
      font-weight:950;
      letter-spacing:.2px;
      box-shadow: 0 10px 25px rgba(0,0,0,.22);
      position:relative;
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:78px;
    }
    .cta:active{transform: translateY(1px);}
    .cta .btn-inner{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:4px;
      padding:0 10px;
      text-align:center;
    }
    .cta .main{
      font-size:18px;
      line-height:1.1;
    }
    .cta .sub{
      font-size:12px;
      opacity:.85;
      font-weight:800;
    }

    /* Info chips row */
    .chipRow{
      margin-top:14px;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.18);
      padding:10px;
      border-radius: 16px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.10);
    }
    .chip{
      background: rgba(255,255,255,.12);
      border:1px solid rgba(255,255,255,.20);
      color:#fff;
      padding:9px 12px;
      border-radius:999px;
      font-weight:850;
      font-size:13px;
      display:flex;
      gap:8px;
      align-items:center;
      user-select:none;
    }
    .chip strong{color:#fff}
    .chip .dot2{
      width:8px;height:8px;border-radius:99px;
      background: rgba(255,204,77,.95);
      box-shadow: 0 0 0 3px rgba(255,204,77,.20);
    }

    /* Filter pills */
    .filters{
      margin-top:12px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
    }
    .filterPill{
      background:#fff;
      border:1px solid #e5e7eb;
      border-radius:999px;
      padding:10px 14px;
      font-weight:900;
      cursor:pointer;
      box-shadow: 0 8px 20px rgba(0,0,0,.10);
      user-select:none;
      color:#0b1220;
    }
    .filterPill.on{
      background: #eaf3ff;
      border-color: rgba(11,92,255,.35);
      color:#062b6f;
    }
    .filters .sep{width:1px;height:28px;background:rgba(255,255,255,.25); margin:0 2px;}

    /* Main content */
    .main{
      padding: 26px 0 60px;
    }
    h2{
      font-size:44px;
      letter-spacing:-.8px;
      margin:20px 0 6px;
    }
    .hint{
      color:#64748b;
      font-weight:700;
      margin:0 0 18px;
    }
    .resultsFraming{
      background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
      border: 2px solid #bae6fd;
      border-radius: 16px;
      padding: 18px 22px;
      margin: 20px 0 18px;
    }
    .resultsFraming .framingTitle{
      font-size: 18px;
      font-weight: 950;
      color: #0c4a6e;
      margin: 0 0 4px;
    }
    .resultsFraming .framingText{
      font-size: 15px;
      font-weight: 750;
      color: #075985;
      margin: 0;
    }
    .evalCard{
      background: linear-gradient(135deg, #fefce8 0%, #fef9c3 100%);
      border: 2px solid #fde047;
      border-radius: 18px;
      padding: 24px;
      margin: 16px 0;
      box-shadow: 0 12px 35px rgba(253, 224, 71, .15);
    }
    .evalCard .evalTitle{
      font-size: 26px;
      font-weight: 950;
      color: #0b1220;
      margin: 0 0 16px;
      letter-spacing: -.4px;
    }
    .evalSection{
      margin: 20px 0;
      padding: 16px;
      background: rgba(255,255,255,.7);
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,.08);
    }
    .evalSection h4{
      font-size: 16px;
      font-weight: 950;
      color: #0b1220;
      margin: 0 0 10px;
    }
    .statusLabel{
      display: inline-block;
      padding: 8px 14px;
      border-radius: 999px;
      font-weight: 950;
      font-size: 14px;
      margin: 8px 0;
    }
    .statusLabel.likely{
      background: #dcfce7;
      color: #166534;
      border: 2px solid #86efac;
    }
    .statusLabel.stretch{
      background: #fef3c7;
      color: #92400e;
      border: 2px solid #fcd34d;
    }
    .statusLabel.unlikely{
      background: #fee2e2;
      color: #991b1b;
      border: 2px solid #fca5a5;
    }
    .mergePrompt{
      background: #fff;
      border: 2px dashed #cbd5e1;
      border-radius: 16px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
    }
    .mergePrompt .mergeTitle{
      font-size: 18px;
      font-weight: 950;
      color: #0b1220;
      margin: 0 0 12px;
    }
    .mergeBtn{
      background: linear-gradient(135deg, #0b5cff, #0047cc);
      border: none;
      color: #fff;
      padding: 14px 24px;
      border-radius: 12px;
      font-weight: 950;
      font-size: 16px;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(11, 92, 255, .25);
      transition: all .12s ease;
    }
    .mergeBtn:hover{
      transform: translateY(-1px);
      box-shadow: 0 12px 28px rgba(11, 92, 255, .35);
    }
    .mergeBtn:active{
      transform: translateY(0);
    }
    .advancedFilters{
      margin: 20px 0;
      padding: 18px;
      background: #fafbfc;
      border: 1px solid #e5e7eb;
      border-radius: 14px;
    }
    .advancedFilters .advTitle{
      font-size: 16px;
      font-weight: 950;
      color: #0b1220;
      margin: 0 0 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .advancedFilters .advBody{
      margin-top: 14px;
    }
    .helperText{
      font-size: 13px;
      color: #64748b;
      font-weight: 750;
      margin: 8px 0 0;
      font-style: italic;
    }
    .refineSection{
      margin: 24px 0;
      padding: 20px;
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 16px;
    }
    .refineSection h3{
      font-size: 20px;
      font-weight: 950;
      color: #0b1220;
      margin: 0 0 14px;
    }

    /* Cards */
    .card{
      background: var(--card);
      border:1px solid #e5e7eb;
      border-radius: 18px;
      padding:18px;
      box-shadow: var(--shadow2);
      margin: 14px 0;
      cursor:pointer;
      transition: transform .08s ease;
    }
    .card:active{transform: translateY(1px);}
    .cardTop{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
    }
    .cardTitle{
      font-size:22px;
      font-weight:950;
      margin:0 0 8px;
      letter-spacing:-.2px;
    }
    .match{
      font-size:20px;
      font-weight:950;
      color:#0b5cff;
      white-space:nowrap;
    }
    .tags{
      display:flex; flex-wrap:wrap; gap:8px;
      margin-bottom:10px;
    }
    .tag{
      font-size:13px;
      font-weight:900;
      color:#334155;
      background:#f1f5f9;
      border:1px solid #e2e8f0;
      padding:6px 10px;
      border-radius:999px;
    }
    .facts{
      display:grid;
      grid-template-columns: repeat(4, minmax(0,1fr));
      gap:10px;
      margin-top:8px;
    }
    .fact{
      background:#f8fafc;
      border:1px solid #e2e8f0;
      border-radius: 14px;
      padding:10px 12px;
    }
    .fact .k{font-size:12px;color:#64748b;font-weight:900;margin-bottom:4px;}
    .fact .v{font-size:14px;color:#0b1220;font-weight:900;}

    .cardBody{
      margin-top:12px;
      display:none;
      border-top:1px solid #e5e7eb;
      padding-top:14px;
    }
    .card.open .cardBody{display:block;}

    .sectionTitle{
      font-weight:950;
      margin:12px 0 6px;
      color:#0b1220;
    }
    .bullets{
      margin:0;
      padding-left:18px;
      color:#0f172a;
      font-weight:750;
    }
    .bullets li{margin:6px 0;}
    .noteRow{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:10px;
    }
    .badge{
      font-size:12px;
      font-weight:950;
      padding:7px 10px;
      border-radius:999px;
      border:1px solid #e5e7eb;
      background:#fff;
      color:#0b1220;
    }
    .badge.rule{background:#fff7e0;border-color:#ffe08a;}
    .badge.formal{background:#e8fff4;border-color:#86efac;}
    .badge.varies{background:#eef2ff;border-color:#c7d2fe;}
    .sources{
      margin-top:8px;
      font-size:13px;
      color:#64748b;
      font-weight:750;
    }

    .btnRow{
      display:flex;
      gap:10px;
      margin-top:16px;
    }
    .ghost{
      background:#fff;
      border:1px solid #e5e7eb;
      border-radius: 14px;
      padding:10px 14px;
      font-weight:950;
      cursor:pointer;
    }

    /* Profession dropdown (booking-ish) */
    .dropdown{
      position:relative;
      width:100%;
    }
    .dropPanel{
      position:absolute;
      left:0; right:0;
      top:74px;
      background:#fff;
      border-radius: 18px;
      border:1px solid #e5e7eb;
      box-shadow: var(--shadow);
      overflow:hidden;
      display:none;
      z-index:30;
    }
    .dropPanel.open{display:block;}
    .dropHeader{
      padding:14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      border-bottom:1px solid #eef2f7;
      background: linear-gradient(180deg, #fbfdff, #ffffff);
    }
    .dropHeader .t{
      font-size:20px;
      font-weight:950;
      color:#0b1220;
    }
    .dropHeader .h{
      font-size:13px;
      color:#6b7280;
      font-weight:850;
    }
    .dropList{
      max-height: 360px;
      overflow:auto;
    }
    .row{
      display:flex;
      gap:12px;
      padding:14px 16px;
      cursor:pointer;
      border-bottom:1px solid #f1f5f9;
      align-items:center;
      color:#0b1220;             /* FIX: not white */
      background:#fff;
    }
    .row:hover{background:#f7fbff;}
    .row.active{background:#eef6ff;}
    .rowIcon{
      width:42px;height:42px;border-radius:999px;
      background:#f1f5f9;
      border:1px solid #e2e8f0;
      display:flex;align-items:center;justify-content:center;
      flex:0 0 auto;
    }
    .rowMain{min-width:0;}
    .rowMain .name{
      font-weight:950;
      font-size:16px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      color:#0b1220;
    }
    .rowMain .meta{
      font-weight:850;
      font-size:13px;
      color:#64748b;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    /* Modal (ATAR vs GPA) */
    .modalWrap{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.55);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:50;
      padding:18px;
    }
    .modalWrap.show{display:flex;}
    .modal{
      width:min(760px, 95vw);
      border-radius: 18px;
      overflow:hidden;
      box-shadow: var(--shadow);
      background:#fff;
    }
    .modalTop{
      background: linear-gradient(180deg, #0a4bb8, #062b6f);
      padding:18px 18px 14px;
      color:#fff;
    }
    .modalTop h3{
      margin:0 0 6px;
      font-size:28px;
      letter-spacing:-.4px;
    }
    .modalTop p{
      margin:0;
      color:rgba(255,255,255,.88);
      font-weight:750;
      line-height:1.35;
    }
    .modalBody{
      padding:16px 16px 14px;
    }
    .modeGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    .modeCard{
      border:1px solid #e5e7eb;
      border-radius: 16px;
      padding:14px;
      cursor:pointer;
      box-shadow: 0 8px 20px rgba(0,0,0,.08);
      background:#fff;
    }
    .modeCard:hover{background:#f7fbff;}
    .modeCard .m1{font-weight:950; font-size:18px; margin-bottom:2px;}
    .modeCard .m2{color:#64748b; font-weight:800; font-size:13px;}
    .modalFoot{
      padding:0 16px 14px;
      color:#64748b;
      font-weight:800;
      font-size:13px;
    }

    /* Responsive */
    @media (max-width: 980px){
      .searchGrid{grid-template-columns: 1fr; }
      .cta{min-height:64px;}
      .facts{grid-template-columns: 1fr 1fr;}
      .hero h1{font-size:42px;}
      .intentFork{grid-template-columns: 1fr;}
      .intentCard .badge-primary{top: 12px; right: 12px; font-size: 10px; padding: 4px 8px;}
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="brand"><span class="dot"></span><span>CareerPicker</span></div>
    <div class="top-actions">
      <div class="pill">About</div>
      <div class="pill primary">Save (later)</div>
    </div>
  </div>

  <section class="hero">
    <div class="wrap">
      <h1>Find your next career</h1>
      <p id="heroLine">
        Two ways to start: explore options based on your score, or evaluate a dream job.
        Pick your starting point below.
      </p>

      <!-- Intent fork CTAs -->
      <div class="intentFork" id="intentFork">
        <div class="intentCard primary" data-intent="score-first" id="intentScoreFirst">
          <span class="badge-primary">Primary</span>
          <span class="emoji">üéØ</span>
          <h3 class="intentTitle">I have an ATAR/GPA ‚Äî show my options</h3>
          <p class="intentDesc">See realistic career pathways based on your score. Quick exploration mode.</p>
        </div>
        <div class="intentCard" data-intent="job-first" id="intentJobFirst">
          <span class="emoji">‚≠ê</span>
          <h3 class="intentTitle">I have a dream job ‚Äî what ATAR do I need?</h3>
          <p class="intentDesc">Evaluate a specific career and get a reality check with alternative pathways.</p>
        </div>
      </div>

      <div class="searchRow" id="searchRow" style="display:none;">
        <div class="searchGrid">
          <!-- Profession -->
          <div class="field">
            <div class="icon" aria-hidden="true">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M7 7h10v14H7V7z" stroke="#0f172a" stroke-width="1.8" />
                <path d="M9 7V5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2" stroke="#0f172a" stroke-width="1.8"/>
              </svg>
            </div>
            <div class="fieldcol">
              <div class="label">Already have a job in mind? (optional)</div>
              <div class="dropdown">
                <input id="professionInput" class="inputlike" placeholder="Start typing‚Ä¶ (real list only)" autocomplete="off" />
                <div class="sub" id="professionSub">Explore mode: leave blank to see options for your score.</div>

                <div class="dropPanel" id="dropPanel">
                  <div class="dropHeader">
                    <div class="t">Professions</div>
                    <div class="h">Type to filter ‚Ä¢ Scroll ‚Ä¢ Enter to select</div>
                  </div>
                  <div class="dropList" id="dropList"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Score -->
          <div class="field">
            <div class="icon" aria-hidden="true">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M7 3h10v18H7V3z" stroke="#0f172a" stroke-width="1.8"/>
                <path d="M9 7h6M9 11h6M9 15h4" stroke="#0f172a" stroke-width="1.8"/>
              </svg>
            </div>
            <div class="fieldcol">
              <div class="label" id="scoreLabel">ATAR (0.00‚Äì99.95)</div>
              <div class="smallrow">
                <input id="scoreInput" class="inputlike" inputmode="decimal" value="70.00" />
              </div>
              <div class="sub" id="modeText">Mode: ATAR</div>
            </div>
          </div>

          <!-- Salary circumstance -->
          <div class="field">
            <div class="icon" aria-hidden="true">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M12 2v20" stroke="#0f172a" stroke-width="1.8"/>
                <path d="M17 6.5c0-1.7-1.6-3-5-3s-5 1.3-5 3 1.2 2.6 5 3 5 1.3 5 3-1.6 3-5 3-5-1.3-5-3" stroke="#0f172a" stroke-width="1.8"/>
              </svg>
            </div>
            <div class="fieldcol">
              <div class="label">Salary circumstance (AUD)</div>
              <div class="value" style="margin-top:2px;">
                <select id="salarySelect" class="inputlike" style="font-size:18px;font-weight:950;">
                  <option value="self">Low ‚Äî self only ($45k‚Äì$70k)</option>
                  <option value="couple" selected>Medium ‚Äî couple/shared ($70k‚Äì$110k)</option>
                  <option value="family">High ‚Äî family costs ($110k‚Äì$160k)</option>
                  <option value="growth">High growth ‚Äî ambitious ($160k+)</option>
                </select>
              </div>
              <div class="sub">Used to bias results (not a promise).</div>
            </div>
          </div>

          <!-- CTA -->
          <button class="cta" id="searchBtn" type="button" aria-label="Get shortlist">
            <div class="btn-inner">
              <div class="main" id="ctaText">Show careers for my ATAR</div>
              <div class="sub" id="ctaSub">Score-first (explore mode)</div>
            </div>
          </button>
        </div>
      </div>

      <div class="chipRow">
        <div class="chip"><span class="dot2"></span><strong>Real-list matching</strong></div>
        <div class="chip"><span class="dot2"></span><strong>Explainable output</strong></div>
        <div class="chip"><span class="dot2"></span><strong>Prototype-safe evidence notes</strong></div>
        <div class="chip" id="eligibleChip"><span class="dot2"></span><strong>Eligible in list:</strong> 0 / 0</div>
      </div>

      <div class="filters" id="filters">
        <div class="filterPill on" data-group="study" data-value="any">Study: Any</div>
        <div class="filterPill" data-group="study" data-value="0-1">0‚Äì1y</div>
        <div class="filterPill" data-group="study" data-value="2-3">2‚Äì3y</div>
        <div class="filterPill" data-group="study" data-value="4+">4y+</div>
        <div class="sep"></div>
        <div class="filterPill on" data-group="ps" data-value="any">People/Systems: Any</div>
        <div class="filterPill" data-group="ps" data-value="people">More people</div>
        <div class="filterPill" data-group="ps" data-value="systems">More systems</div>
        <div class="sep"></div>
        <div class="filterPill on" data-group="da" data-value="any">Desk/Active: Any</div>
        <div class="filterPill" data-group="da" data-value="desk">Desk</div>
        <div class="filterPill" data-group="da" data-value="active">On-feet</div>
        <div class="sep"></div>
        <div class="filterPill on" data-group="io" data-value="any">Indoor/Outdoor: Any</div>
        <div class="filterPill" data-group="io" data-value="indoor">Indoor</div>
        <div class="filterPill" data-group="io" data-value="outdoor">Outdoor</div>
      </div>
    </div>
  </section>

  <main class="main">
    <div class="wrap">
      <div id="resultsFramingContainer"></div>
      
      <h2 id="mainHeading">Your shortlist</h2>
      <p class="hint" id="mainHint">Click a card to expand details. (Each card is different.)</p>

      <div id="evaluationContainer"></div>
      <div id="mergePromptContainer"></div>
      <div id="refineContainer"></div>
      <div id="results"></div>

      <div class="btnRow">
        <button class="ghost" id="resetBtn">Reset</button>
      </div>
    </div>
  </main>

  <!-- Mode modal -->
  <div class="modalWrap" id="modeModal" role="dialog" aria-modal="true">
    <div class="modal">
      <div class="modalTop">
        <h3>Start: Are you using ATAR or GPA?</h3>
        <p>
          We‚Äôll filter professions based on your score. Low scores still have options (traineeships, retail, hospitality, trades).<br/>
          Example: ‚ÄúDoctor‚Äù won‚Äôt appear unless your score is high enough.
        </p>
      </div>
      <div class="modalBody">
        <div class="modeGrid">
          <div class="modeCard" data-mode="ATAR">
            <div class="m1">ATAR (0‚Äì99.95)</div>
            <div class="m2">Australian high school planning.</div>
          </div>
          <div class="modeCard" data-mode="GPA">
            <div class="m1">GPA (0‚Äì100)</div>
            <div class="m2">If you‚Äôre treating GPA like a 0‚Äì100 score.</div>
          </div>
        </div>
      </div>
      <div class="modalFoot">
        Note: These are simple cutoffs (not official requirements). We can refine later by university/state.
      </div>
    </div>
  </div>

  <script>
    // ---------- State ----------
    const state = {
      mode: null,                 // "ATAR" | "GPA"
      intent: null,               // "score-first" | "job-first" - tracks user's primary entry flow
      score: 70.00,
      salary: "couple",            // self | couple | family | growth
      selectedProfession: null,    // profession object
      filters: {
        study: "any",  // any | 0-1 | 2-3 | 4+
        ps: "any",     // any | people | systems
        da: "any",     // any | desk | active
        io: "any"      // any | indoor | outdoor
      },
      showAdvancedFilters: false,  // toggle for lifestyle goal section
      contextMerged: false         // true when user adds second context (ATAR+job or job+ATAR)
    };

    // ---------- Helpers ----------
    const $ = (id) => document.getElementById(id);

    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

    function parseScore(raw){
      const x = Number(String(raw).replace(/[^0-9.]/g,''));
      if (!Number.isFinite(x)) return null;
      if (state.mode === "ATAR") return clamp(x, 0, 99.95);
      return clamp(x, 0, 100);
    }

    function salaryBiasPoints(salaryBand){
      // IMPORTANT: Salary is used for RANKING BIAS ONLY, not exclusion
      // It adds 0-12 points to scoring to prioritize matching salary bands
      const map = {
        self:   {low: 10, mid: 4,  high: 1,  elite: 0},
        couple: {low: 3,  mid: 10, high: 4,  elite: 1},
        family: {low: 1,  mid: 4,  high: 10, elite: 5},
        growth: {low: 0,  mid: 2,  high: 7,  elite: 12},
      };
      return (map[state.salary] || map.couple)[salaryBand] ?? 0;
    }

    // ---------- Intent flow helpers ----------
    function selectIntent(intent){
      state.intent = intent;
      
      // Visual feedback
      document.querySelectorAll('.intentCard').forEach(card => {
        card.classList.remove('selected');
      });
      $(`intent${intent === 'score-first' ? 'ScoreFirst' : 'JobFirst'}`).classList.add('selected');
      
      // Show search row and render appropriate fields
      $('searchRow').style.display = 'block';
      renderSearchRow();
      
      // Update hero text
      if (intent === 'score-first'){
        $('heroLine').innerHTML = 'Enter your <strong>ATAR/GPA</strong> to see realistic career pathways. Profession filter is optional.';
      } else {
        $('heroLine').innerHTML = 'Search for your <strong>dream job</strong> and we\'ll show you what it takes, plus smart alternative pathways.';
      }
      
      // Scroll to search row smoothly
      setTimeout(() => {
        $('searchRow').scrollIntoView({behavior: 'smooth', block: 'nearest'});
      }, 100);
    }
    
    function renderSearchRow(){
      const grid = $('searchGrid');
      
      if (state.intent === 'score-first'){
        // Flow A: Score-first layout
        grid.innerHTML = `
          <!-- Score (dominant) -->
          <div class="field" style="grid-column: span 1;">
            <div class="icon" aria-hidden="true">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M7 3h10v18H7V3z" stroke="#0f172a" stroke-width="1.8"/>
                <path d="M9 7h6M9 11h6M9 15h4" stroke="#0f172a" stroke-width="1.8"/>
              </svg>
            </div>
            <div class="fieldcol">
              <div class="label" id="scoreLabel">ATAR (0.00‚Äì99.95)</div>
              <div class="smallrow">
                <input id="scoreInput" class="inputlike" inputmode="decimal" value="70.00" />
              </div>
              <div class="sub" id="modeText">Mode: ATAR</div>
            </div>
          </div>
          
          <!-- CTA -->
          <button class="cta" id="searchBtn" type="button" aria-label="Get shortlist" style="grid-column: span 1;">
            <div class="btn-inner">
              <div class="main" id="ctaText">Show my options ‚Üí</div>
              <div class="sub" id="ctaSub">Exploring by score</div>
            </div>
          </button>
        `;
        
        // Re-attach listeners
        $('scoreInput').addEventListener('input', autoRun);
        $('searchBtn').addEventListener('click', () => runSearch(true));
        
      } else {
        // Flow B: Job-first layout
        grid.innerHTML = `
          <!-- Profession (required) -->
          <div class="field" style="grid-column: span 1;">
            <div class="icon" aria-hidden="true">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M7 7h10v14H7V7z" stroke="#0f172a" stroke-width="1.8" />
                <path d="M9 7V5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2" stroke="#0f172a" stroke-width="1.8"/>
              </svg>
            </div>
            <div class="fieldcol">
              <div class="label">Search for a career‚Ä¶</div>
              <div class="dropdown">
                <input id="professionInput" class="inputlike" placeholder="Type to search (e.g., Doctor, Nurse, Lawyer)" autocomplete="off" />
                <div class="sub" id="professionSub">Select from real list of ~220 professions</div>

                <div class="dropPanel" id="dropPanel">
                  <div class="dropHeader">
                    <div class="t">Professions</div>
                    <div class="h">Type to filter ‚Ä¢ Scroll ‚Ä¢ Enter to select</div>
                  </div>
                  <div class="dropList" id="dropList"></div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- CTA -->
          <button class="cta" id="searchBtn" type="button" aria-label="Evaluate job" style="grid-column: span 1;">
            <div class="btn-inner">
              <div class="main" id="ctaText">Evaluate this career ‚Üí</div>
              <div class="sub" id="ctaSub">Get reality check + alternatives</div>
            </div>
          </button>
        `;
        
        // Re-attach profession dropdown listeners
        $('professionInput').addEventListener('focus', () => {
          openDrop();
          renderDropList();
        });
        $('professionInput').addEventListener('input', () => {
          if (state.selectedProfession && $('professionInput').value.trim() !== state.selectedProfession.name){
            state.selectedProfession = null;
            $('professionSub').textContent = 'Select from real list of ~220 professions';
          }
          openDrop();
          renderDropList();
        });
        $('professionInput').addEventListener('keydown', handleDropdownKeyboard);
        $('searchBtn').addEventListener('click', () => runSearch(true));
      }
    }

    function labelForMode(){
      if (state.mode === "GPA") return {label:"GPA (0‚Äì100)", max:100};
      return {label:"ATAR (0.00‚Äì99.95)", max:99.95};
    }

    // ---------- Profession dataset ----------
    // Goal: "way more jobs" + real list filtering + always some low-score options.
    // We generate ~220 items from curated cores + variants.
    const BASE = [
      // Health
      {name:"Doctor", cat:"Health", minATAR:95.0, minGPA:90, study: "4+", ps:"people", da:"active", io:"indoor", salary:"elite",
        tags:["Medicine","Hospital","Care","Diagnosis"],
        why:["High academic cutoff (varies by uni/state).","Long training pathway.","High responsibility + strong long-term earnings."],
        start:["Strong science subjects (bio/chem recommended).","Research med entry pathways + prerequisites.","Volunteer/shadow where possible."],
        evidence:{formal:["University prerequisites + selection ranks vary."], rule:["Often requires top ATAR / high GPA."], varies:["State/uni & pathway (postgrad) change cutoffs."]}},
      {name:"Nurse", cat:"Health", minATAR:65.0, minGPA:60, study: "2-3", ps:"people", da:"active", io:"indoor", salary:"mid",
        tags:["Care","Hospital","Teamwork","Shift work"],
        why:["People-focused + practical work.","Many entry pathways (uni/TAFE).","Stable demand across Australia."],
        start:["Look up Bachelor of Nursing requirements.","Consider EN-to-RN pathway via TAFE.","First aid + volunteering helps."],
        evidence:{formal:["Registration required (AHPRA)."], rule:["Shift work common."], varies:["Entry depends on provider + locations."]}},
      {name:"Paramedic", cat:"Health", minATAR:78.0, minGPA:72, study:"2-3", ps:"people", da:"active", io:"outdoor", salary:"high",
        tags:["Emergency","Ambulance","Critical care","Stress"],
        why:["Hands-on urgent care.","Competitive in some states.","Fitness + communication important."],
        start:["Check state ambulance services + uni programs.","Improve fitness + first aid.","Build customer service + calm under pressure."],
        evidence:{formal:["Service selection processes vary."], rule:["Fitness testing common."], varies:["State intake changes yearly."]}},
      {name:"Psychologist", cat:"Health", minATAR:85.0, minGPA:78, study:"4+", ps:"people", da:"desk", io:"indoor", salary:"high",
        tags:["Mental health","Counselling","Research","Listening"],
        why:["People + communication heavy.","Postgrad often needed for registration.","Wide workplaces (schools, clinics, orgs)."],
        start:["Check accredited psychology pathways.","Build writing/research skills.","Volunteer in support roles."],
        evidence:{formal:["Accreditation + registration rules apply."], rule:["Postgrad is common for full registration."], varies:["Specialties have different pathways."]}},

      // Law / Justice / Government
      {name:"Lawyer", cat:"Law", minATAR:88.0, minGPA:80, study:"4+", ps:"people", da:"desk", io:"indoor", salary:"high",
        tags:["Law","Court","Contracts","Advice"],
        why:["Good match if you enjoy reading/writing/argument.","Entry depends on university selection + performance.","Strong progression once qualified."],
        start:["Research law degrees + double degrees.","Build writing + logic skills.","Try debating / mock trial."],
        evidence:{formal:["Admission requirements apply after degree."], rule:["Top firms are highly competitive."], varies:["Cutoffs vary by uni."]}},
      {name:"Paralegal", cat:"Law", minATAR:55.0, minGPA:55, study:"0-1", ps:"people", da:"desk", io:"indoor", salary:"mid",
        tags:["Legal support","Documents","Admin","Detail"],
        why:["Entry via diploma/experience possible.","Strong for detail + organisation.","Can be a pathway into law."],
        start:["Consider legal studies diploma/TAFE.","Build admin + writing skills.","Look for junior roles in firms."],
        evidence:{formal:["None always required."], rule:["Experience can matter more than ATAR."], varies:["Employer expectations differ."]}},
      {name:"Police Officer", cat:"Justice", minATAR:45.0, minGPA:45, study:"0-1", ps:"people", da:"active", io:"outdoor", salary:"mid",
        tags:["Public service","Fitness","Communication","Training"],
        why:["Fits if you like structure + public service.","Physical + communication skills matter.","Clear training pipelines."],
        start:["Check state police recruitment requirements.","Build fitness + community experience.","Work on calm decision-making."],
        evidence:{formal:["Recruitment tests + background checks."], rule:["Fitness + communication are key."], varies:["State rules differ."]}},
      {name:"Detective", cat:"Justice", minATAR:60.0, minGPA:60, study:"2-3", ps:"people", da:"active", io:"outdoor", salary:"high",
        tags:["Investigation","Interviews","Evidence","Casework"],
        why:["Usually a progression from policing.","Strong for curiosity + persistence.","Paperwork + people skills both matter."],
        start:["Start with policing or relevant degrees.","Practice report writing.","Develop observation skills."],
        evidence:{formal:["Internal selection/progression applies."], rule:["Not entry-level in most places."], varies:["Agency pathways differ."]}},
      {name:"Policy Officer", cat:"Government", minATAR:65.0, minGPA:60, study:"2-3", ps:"systems", da:"desk", io:"indoor", salary:"mid",
        tags:["Government","Systems","Research","Impact"],
        why:["Good if you like systems + fairness + large-scale impact.","Stable career paths.","Can combine with law/business."],
        start:["Consider public policy/arts/law degrees.","Build writing + analysis skills.","Follow current affairs + submissions."],
        evidence:{formal:["Role requirements vary by department."], rule:["Strong writing is a must."], varies:["APS/VPS/State hiring differs."]}},

      // Tech
      {name:"Software Developer", cat:"Tech", minATAR:60.0, minGPA:60, study:"2-3", ps:"systems", da:"desk", io:"indoor", salary:"high",
        tags:["Coding","Apps","Problem solving","Build"],
        why:["Strong for analytical problem solving.","Multiple entry paths (uni/TAFE/self-taught).","Good salary growth over time."],
        start:["Learn basics (Python/JS).","Build 2 small projects.","Try a diploma or CS/IT degree."],
        evidence:{formal:["None strictly required."], rule:["Portfolio matters a lot."], varies:["Employers differ on degrees."]}},
      {name:"Cybersecurity Analyst", cat:"Tech", minATAR:70.0, minGPA:68, study:"2-3", ps:"systems", da:"desk", io:"indoor", salary:"high",
        tags:["Security","Networks","Risk","Blue team"],
        why:["Systems-minded + detail-heavy.","Growing demand.","Certs help (but not mandatory)."],
        start:["Learn networking basics.","Try labs (CTFs).","Consider entry IT role ‚Üí security."],
        evidence:{formal:["Some gov roles need clearances."], rule:["Certs can boost employability."], varies:["Specialties vary widely."]}},
      {name:"Data Analyst", cat:"Tech", minATAR:65.0, minGPA:62, study:"2-3", ps:"systems", da:"desk", io:"indoor", salary:"high",
        tags:["Data","Excel/SQL","Insights","Charts"],
        why:["Great if you like patterns + numbers.","Wide industries.","Clear portfolio projects possible."],
        start:["Learn Excel + SQL.","Do a small dataset project.","Study business analytics / IT."],
        evidence:{formal:["None required for many roles."], rule:["Projects > grades often."], varies:["Tools differ by company."]}},

      // Trades / Low score must-have options
      {name:"Electrician", cat:"Trades", minATAR:20.0, minGPA:20, study:"2-3", ps:"systems", da:"active", io:"indoor", salary:"high",
        tags:["Apprenticeship","Hands-on","Licensed","Building"],
        why:["Strong option at low scores (apprenticeship).","Good long-term earnings once qualified.","Practical + problem-solving work."],
        start:["Look for apprenticeship programs.","Get white card + basic safety.","Build math + wiring fundamentals."],
        evidence:{formal:["Licensing required."], rule:["Apprenticeships are the main route."], varies:["State licensing rules differ."]}},
      {name:"Plumber", cat:"Trades", minATAR:15.0, minGPA:15, study:"2-3", ps:"people", da:"active", io:"outdoor", salary:"high",
        tags:["Apprenticeship","On-site","Fix/build","Licensed"],
        why:["Hands-on + strong demand.","Good pathways without high ATAR.","Income improves with experience."],
        start:["Apply for apprenticeship.","Get basic tickets (white card).","Build physical stamina + customer skills."],
        evidence:{formal:["Licensing required."], rule:["Weekend/emergency work can pay more."], varies:["Specialties (gas/roof) differ."]}},
      {name:"Retail Team Member", cat:"Retail", minATAR:0.0, minGPA:0, study:"0-1", ps:"people", da:"active", io:"indoor", salary:"low",
        tags:["Customer service","Entry","Flexible","Skills"],
        why:["Accessible at any score.","Builds communication + reliability.","Can lead to supervisor/manager roles."],
        start:["Resume + availability.","Practice customer service.","Learn POS + stock basics."],
        evidence:{formal:["None."], rule:["Reliability is the #1 factor."], varies:["Pay varies by award/role."]}},
      {name:"Hospitality Crew", cat:"Hospitality", minATAR:0.0, minGPA:0, study:"0-1", ps:"people", da:"active", io:"indoor", salary:"low",
        tags:["Fast pace","Customer","Teamwork","Shifts"],
        why:["Accessible + fast skill building.","Great for people skills.","Can move into chef/manager routes."],
        start:["RSA/food handling (if needed).","Learn time management.","Apply widely."],
        evidence:{formal:["Some venues require certificates."], rule:["Weekend shifts common."], varies:["Pay/conditions vary."]}},
    ];

    // Add more categories quickly via templates (to reach ~220 jobs).
    const CATEGORY_SEEDS = [
      // name, cat, minATAR, study, ps, da, io, salaryBand, tags
      ["Accountant","Business",70,"2-3","systems","desk","indoor","high",["Finance","Compliance","Reporting","Detail"]],
      ["Marketing Specialist","Business",55,"2-3","people","desk","indoor","mid",["Campaigns","Brand","Copy","Analytics"]],
      ["Teacher (Primary)","Education",70,"4+","people","active","indoor","mid",["Teaching","Kids","Planning","Care"]],
      ["Teacher (Secondary)","Education",75,"4+","people","active","indoor","mid",["Teaching","Subjects","Planning","Care"]],
      ["Chef","Hospitality",20,"2-3","people","active","indoor","mid",["Food","Kitchen","Skills","Pressure"]],
      ["Mechanic","Trades",10,"2-3","systems","active","indoor","high",["Cars","Fixing","Tools","Apprenticeship"]],
      ["Carpenter","Trades",10,"2-3","systems","active","outdoor","high",["Building","Tools","Apprenticeship","Site"]],
      ["Graphic Designer","Creative",50,"2-3","people","desk","indoor","mid",["Design","Visual","Portfolio","Brand"]],
      ["UI/UX Designer","Creative",65,"2-3","people","desk","indoor","high",["Design","Research","Prototypes","Product"]],
      ["Journalist","Media",65,"2-3","people","desk","outdoor","mid",["Writing","News","Interviews","Story"]],
      ["Physiotherapist","Health",85,"4+","people","active","indoor","high",["Rehab","Movement","Care","Science"]],
      ["Pharmacist","Health",88,"4+","people","desk","indoor","high",["Medicines","Accuracy","Care","Science"]],
      ["Architect","Built",80,"4+","systems","desk","indoor","high",["Buildings","Design","CAD","Rules"]],
      ["Civil Engineer","Built",82,"4+","systems","desk","outdoor","high",["Infrastructure","Math","Projects","Sites"]],
      ["Registered Nurse (ICU)","Health",75,"4+","people","active","indoor","high",["Critical care","Hospital","Skills","Shift"]],
      ["Vet Nurse","Health",35,"0-1","people","active","indoor","mid",["Animals","Care","Clinic","Support"]],
      ["Veterinarian","Health",92,"4+","people","active","indoor","high",["Animals","Medicine","Science","Care"]],
      ["Air Traffic Controller","Aviation",85,"2-3","systems","desk","indoor","high",["Safety","Focus","Training","Rules"]],
      ["Pilot","Aviation",80,"2-3","systems","desk","indoor","high",["Flying","Training","Safety","Navigation"]],
      ["Firefighter","Emergency",55,"0-1","people","active","outdoor","high",["Fitness","Rescue","Team","Training"]],
      ["Social Worker","Community",70,"4+","people","desk","indoor","mid",["Support","Care","Communication","Systems"]],
      ["Occupational Therapist","Health",85,"4+","people","active","indoor","high",["Rehab","Care","Plans","Science"]],
      ["Speech Pathologist","Health",85,"4+","people","desk","indoor","high",["Communication","Care","Kids","Therapy"]],
      ["Dentist","Health",97,"4+","people","desk","indoor","elite",["Teeth","Precision","Care","Clinic"]],
      ["Dental Assistant","Health",20,"0-1","people","active","indoor","mid",["Clinic","Support","Care","Sterilization"]],
      ["Surveyor","Built",65,"2-3","systems","active","outdoor","high",["Mapping","Sites","Tools","Math"]],
      ["Real Estate Agent","Sales",30,"0-1","people","active","outdoor","mid",["Sales","Homes","Commission","People"]],
      ["Business Analyst","Business",70,"2-3","systems","desk","indoor","high",["Requirements","Process","Stakeholders","Data"]],
      ["Project Manager","Business",65,"2-3","people","desk","indoor","high",["Planning","Teams","Delivery","Comms"]],
      ["Navy Officer","Defence",70,"2-3","people","active","outdoor","mid",["Leadership","Training","Service","Discipline"]],
      ["Army Technician","Defence",20,"0-1","systems","active","outdoor","mid",["Technical","Training","Service","Tools"]],
      ["Librarian","Education",55,"2-3","people","desk","indoor","mid",["Research","Books","Organisation","Support"]],
      ["Translator","Language",55,"2-3","people","desk","indoor","mid",["Languages","Writing","Culture","Accuracy"]],
      ["Chef de Partie","Hospitality",30,"2-3","people","active","indoor","mid",["Kitchen","Skills","Pressure","Team"]],
      ["Aged Care Worker","Community",0,"0-1","people","active","indoor","low",["Care","Support","Patience","Shifts"]],
      ["Disability Support Worker","Community",0,"0-1","people","active","indoor","mid",["Care","Support","Communication","Plan"]],
      ["Childcare Educator","Education",0,"0-1","people","active","indoor","mid",["Kids","Care","Play","Safety"]],
      ["Barista","Hospitality",0,"0-1","people","active","indoor","low",["Coffee","Customer","Speed","Skills"]],
      ["Truck Driver","Logistics",0,"0-1","systems","active","outdoor","mid",["Driving","Routes","Safety","Deliveries"]],
      ["Warehouse Picker","Logistics",0,"0-1","systems","active","indoor","low",["Warehouse","Speed","Accuracy","Team"]],
      ["Forklift Operator","Logistics",0,"0-1","systems","active","indoor","mid",["Tickets","Safety","Warehouse","Ops"]],
      ["Receptionist","Admin",0,"0-1","people","desk","indoor","low",["Phones","Scheduling","Customer","Admin"]],
      ["Office Administrator","Admin",10,"0-1","people","desk","indoor","mid",["Admin","Docs","Support","Systems"]],
      ["Executive Assistant","Admin",45,"0-1","people","desk","indoor","mid",["Organisation","Calendars","Trust","Speed"]],
      ["HR Coordinator","Business",50,"0-1","people","desk","indoor","mid",["Hiring","People","Process","Support"]],
      ["HR Manager","Business",70,"2-3","people","desk","indoor","high",["People","Policy","Leadership","Comms"]],
      ["Content Creator","Media",20,"0-1","people","desk","indoor","mid",["Video","Social","Story","Consistency"]],
      ["Videographer","Media",35,"0-1","people","active","outdoor","mid",["Camera","Editing","Shoots","Story"]],
      ["Photographer","Media",20,"0-1","people","active","outdoor","mid",["Camera","Clients","Portfolio","Light"]],
      ["Fitness Trainer","Sports",0,"0-1","people","active","indoor","mid",["Fitness","Coaching","Clients","Energy"]],
      ["Nutritionist","Health",70,"2-3","people","desk","indoor","mid",["Food","Advice","Care","Science"]],
    ];

    function buildProfessionList(){
      const out = [];

      // 1) Base curated
      for (const p of BASE) out.push(attachDefaults(p));

      // 2) Seeds + variants to create "wayyy more jobs"
      const variants = [
        ["Assistant","Support ‚Ä¢ entry ‚Ä¢ help"],
        ["Coordinator","Organise ‚Ä¢ logistics ‚Ä¢ details"],
        ["Officer","Compliance ‚Ä¢ process ‚Ä¢ admin"],
        ["Specialist","Focused ‚Ä¢ skilled ‚Ä¢ growth"],
        ["Senior","Experience ‚Ä¢ leadership ‚Ä¢ mentoring"],
      ];

      for (const s of CATEGORY_SEEDS){
        const [name, cat, minATAR, study, ps, da, io, salary, tags] = s;
        out.push(attachDefaults({
          name, cat,
          minATAR, minGPA: Math.max(0, minATAR - 5),
          study, ps, da, io, salary,
          tags,
          why: [
            `Matches ${ps === "people" ? "people-focused" : "systems-focused"} work style.`,
            `Study length: ${study === "0-1" ? "short course/entry pathway" : (study === "2-3" ? "diploma/degree" : "longer degree path")}.`,
            `Typical progression exists with experience.`
          ],
          start: [
            "Look up entry pathways (TAFE/uni/entry role).",
            "Build 1 small project/experience proof (portfolio, volunteering, part-time).",
            "Talk to someone doing the job (short interview)."
          ],
          evidence:{
            formal:["Requirements vary by employer/provider."],
            rule:["Portfolio/experience often boosts entry."],
            varies:["State/industry changes requirements."]
          }
        }));

        // add variants (not for every seed to avoid being too repetitive)
        for (let i=0;i<variants.length;i++){
          const [suffix, meta] = variants[i];
          const vName = `${name} ${suffix}`;
          out.push(attachDefaults({
            name: vName,
            cat,
            minATAR: Math.max(0, minATAR - (i+1)*8),
            minGPA: Math.max(0, (Math.max(0, minATAR - (i+1)*8) - 5)),
            study: i < 2 ? "0-1" : study,
            ps, da, io,
            salary: i === 0 ? "low" : (i === 1 ? "mid" : salary),
            tags: [...tags.slice(0,2), ...meta.split(" ‚Ä¢ ").slice(0,2)].slice(0,4),
            why: [
              `Variant of ${name} (more ${suffix.toLowerCase()} / pathway-focused).`,
              `Good for building skills and moving up into ${name}.`,
              `Score cutoffs here are ‚Äúrule of thumb‚Äù for the prototype.`
            ],
            start: [
              "Start with an entry role or short course.",
              "Ask for more responsibility over time.",
              `Aim toward ${name} as a next step.`
            ],
            evidence:{
              formal:["Depends on employer."],
              rule:["Entry roles are common pathways."],
              varies:["Titles differ across companies."]
            }
          }));
        }
      }

      // 3) Deduplicate by name (keep first)
      const seen = new Set();
      const dedup = [];
      for (const p of out){
        const key = p.name.toLowerCase();
        if (seen.has(key)) continue;
        seen.add(key);
        dedup.push(p);
      }

      // Ensure we have 200+ (we will)
      return dedup;
    }

    function attachDefaults(p){
      return {
        id: p.id || p.name.toLowerCase().replace(/[^a-z0-9]+/g,"-"),
        name: p.name,
        cat: p.cat || "Other",
        minATAR: Number.isFinite(p.minATAR) ? p.minATAR : 0,
        minGPA: Number.isFinite(p.minGPA) ? p.minGPA : 0,
        study: p.study || "0-1",
        ps: p.ps || "any",
        da: p.da || "any",
        io: p.io || "any",
        salary: p.salary || "mid",
        tags: p.tags || [],
        why: p.why || [],
        start: p.start || [],
        evidence: p.evidence || {formal:[], rule:[], varies:[]},
        sources: p.sources || ["Prototype notes (add links later)."],
      };
    }

    const PROFESSIONS = buildProfessionList();

    // ---------- Filtering + scoring ----------
    function isEligibleByScore(p){
      const s = state.score;
      if (state.mode === "GPA") return s >= p.minGPA;
      return s >= p.minATAR;
    }

    function passesFilters(p){
      const f = state.filters;

      if (f.study !== "any"){
        if (p.study !== f.study) return false;
      }
      if (f.ps !== "any"){
        if (p.ps !== f.ps) return false;
      }
      if (f.da !== "any"){
        if (p.da !== f.da) return false;
      }
      if (f.io !== "any"){
        if (p.io !== f.io) return false;
      }
      return true;
    }

    function similarity(a, b){
      // very simple similarity: shared category/tags
      if (!a || !b) return 0;
      let score = 0;
      if (a.cat === b.cat) score += 18;

      const ta = new Set(a.tags.map(x=>x.toLowerCase()));
      const tb = new Set(b.tags.map(x=>x.toLowerCase()));
      for (const t of ta) if (tb.has(t)) score += 6;

      if (a.ps === b.ps) score += 6;
      if (a.da === b.da) score += 4;
      if (a.io === b.io) score += 4;
      if (a.study === b.study) score += 3;

      return score;
    }

    function scoreProfession(p){
      // Base score: closer to your score range + salary bias + filters.
      const s = state.score;
      const req = (state.mode === "GPA") ? p.minGPA : p.minATAR;

      // closeness: if you're well above requirement, slight bonus; if just above, bigger bonus
      const margin = clamp(s - req, 0, 100);
      let base = 35;

      // reward being eligible, but not too far (keeps realistic)
      base += (margin < 8) ? 22 : (margin < 20 ? 16 : 10);

      // salary circumstance bias
      base += salaryBiasPoints(p.salary);

      // if profession selected, add similarity boost
      if (state.selectedProfession){
        base += similarity(state.selectedProfession, p);
      } else {
        // explore mode: small preference for variety + stability at lower scores
        if (s < 45 && (p.cat === "Trades" || p.cat === "Logistics" || p.cat === "Hospitality" || p.cat === "Retail")) base += 10;
      }

      return clamp(base, 5, 99);
    }

    function buildShortlist(){
      // 1) always compute eligible count (score-only)
      const eligibleAll = PROFESSIONS.filter(isEligibleByScore);
      $("eligibleChip").innerHTML = `<span class="dot2"></span><strong>Eligible in list:</strong> ${eligibleAll.length} / ${PROFESSIONS.length}`;

      // 2) actual results: eligible + filters
      let pool = eligibleAll.filter(p => passesFilters(p));

      // 3) if user typed a profession, strongly center around it (but still show related)
      if (state.selectedProfession){
        pool = pool
          .filter(p => p.id !== state.selectedProfession.id)
          .slice(); // copy
      }

      // 4) rank
      const ranked = pool
        .map(p => ({p, score: scoreProfession(p)}))
        .sort((a,b)=> b.score - a.score);

      // 5) pick top 8 (or 0 if none)
      return ranked.slice(0, 8);
    }

    // ---------- Rendering ----------
    function fmtStudy(x){
      if (x === "0-1") return "0‚Äì1 years";
      if (x === "2-3") return "2‚Äì3 years";
      return "4+ years";
    }
    function fmtWork(p){
      const ps = p.ps === "people" ? "People" : "Systems";
      const da = p.da === "desk" ? "Desk" : "On-feet";
      const io = p.io === "indoor" ? "Indoor" : "Outdoor";
      return `${ps} ‚Ä¢ ${da} ‚Ä¢ ${io}`;
    }
    function fmtSalaryBand(p){
      const map = {
        low: "Typical pay: $45k‚Äì$70k",
        mid: "Typical pay: $70k‚Äì$110k",
        high: "Typical pay: $110k‚Äì$160k",
        elite: "Typical pay: $160k+"
      };
      return map[p.salary] || map.mid;
    }
    function reqText(p){
      const v = (state.mode === "GPA") ? p.minGPA.toFixed(0) : p.minATAR.toFixed(2);
      const label = (state.mode === "GPA") ? "GPA" : "ATAR";
      return `Rule-of-thumb cutoff: ${label} ‚â• ${v}`;
    }

    function renderResults(){
      const host = $("results");
      host.innerHTML = "";

      const list = buildShortlist();

      // If explore mode and no results because filters too strict, show a helpful message + relax suggestion.
      if (list.length === 0){
        const d = document.createElement("div");
        d.className = "card";
        d.style.cursor = "default";
        d.innerHTML = `
          <div class="cardTitle">No matches with your current filters.</div>
          <div class="tags">
            <span class="tag">Tip</span>
            <span class="tag">Try Study: Any</span>
            <span class="tag">People/Systems: Any</span>
          </div>
          <ul class="bullets">
            <li>Your score still has options ‚Äî your filters are just very tight right now.</li>
            <li>Set filters back to ‚ÄúAny‚Äù to see a broader shortlist.</li>
          </ul>
        `;
        host.appendChild(d);
        return;
      }

      // If a profession is selected, show it as #0 (anchor card)
      if (state.selectedProfession){
        host.appendChild(renderCard(state.selectedProfession, 100, true));
      }

      for (let i=0;i<list.length;i++){
        host.appendChild(renderCard(list[i].p, list[i].score, false));
      }
    }

    function renderCard(p, score, isAnchor){
      const card = document.createElement("div");
      card.className = "card";
      card.setAttribute("tabindex","0");

      const uniqueWhy = pickUniqueWhy(p, score);
      const uniqueStart = pickUniqueStart(p);

      const anchorTag = isAnchor ? `<span class="tag">Selected profession</span>` : ``;

      card.innerHTML = `
        <div class="cardTop">
          <div>
            <div class="cardTitle">${isAnchor ? "Your pick: " : ""}${escapeHtml(p.name)}</div>
            <div class="tags">
              ${anchorTag}
              <span class="tag">${escapeHtml(p.cat)}</span>
              ${p.tags.slice(0,4).map(t=>`<span class="tag">${escapeHtml(t)}</span>`).join("")}
            </div>
          </div>
          <div class="match">${Math.round(score)}% match</div>
        </div>

        <div class="facts">
          <div class="fact"><div class="k">Study length</div><div class="v">${fmtStudy(p.study)}</div></div>
          <div class="fact"><div class="k">Work style</div><div class="v">${fmtWork(p)}</div></div>
          <div class="fact"><div class="k">Earnings (rough)</div><div class="v">${fmtSalaryBand(p)}</div></div>
          <div class="fact"><div class="k">Eligibility</div><div class="v">${escapeHtml(reqText(p))}</div></div>
        </div>

        <div class="cardBody">
          <div class="sectionTitle">Why you got this</div>
          <ul class="bullets">
            ${uniqueWhy.map(x=>`<li>${escapeHtml(x)}</li>`).join("")}
          </ul>

          <div class="sectionTitle">Day-to-day (quick picture)</div>
          <ul class="bullets">
            ${dayToDayBullets(p).map(x=>`<li>${escapeHtml(x)}</li>`).join("")}
          </ul>

          <div class="sectionTitle">How to start (first 3 steps)</div>
          <ul class="bullets">
            ${uniqueStart.map(x=>`<li>${escapeHtml(x)}</li>`).join("")}
          </ul>

          <div class="sectionTitle">Evidence notes</div>
          <div class="noteRow">
            ${(p.evidence.rule||[]).slice(0,2).map(x=>`<span class="badge rule">Rule of thumb: ${escapeHtml(x)}</span>`).join("")}
            ${(p.evidence.formal||[]).slice(0,2).map(x=>`<span class="badge formal">Formal: ${escapeHtml(x)}</span>`).join("")}
            ${(p.evidence.varies||[]).slice(0,2).map(x=>`<span class="badge varies">Varies: ${escapeHtml(x)}</span>`).join("")}
          </div>

          <div class="sources">
            <strong>Sources (placeholder):</strong>
            ${p.sources.map(s=>escapeHtml(s)).join(" ‚Ä¢ ")}
          </div>
        </div>
      `;

      card.addEventListener("click", () => {
        card.classList.toggle("open");
      });
      card.addEventListener("keydown", (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          card.classList.toggle("open");
        }
      });

      return card;
    }

    function pickUniqueWhy(p, score){
      // Make sure expanded content is NOT identical across cards:
      const s = state.score;
      const modeWord = state.mode === "GPA" ? "GPA" : "ATAR";
      const req = state.mode === "GPA" ? p.minGPA : p.minATAR;
      const margin = Math.max(0, s - req);

      const base = [];
      if (state.selectedProfession){
        base.push(`It shares similarities with your chosen profession (category/tags/work style).`);
      } else {
        base.push(`Explore mode: this is a realistic option at your ${modeWord} score.`);
      }

      if (margin < 8) base.push(`It‚Äôs close to your current score ‚Äî competitive but plausible if you keep improving.`);
      else if (margin < 20) base.push(`You‚Äôre comfortably above the rough cutoff, so it‚Äôs a solid ‚Äúsafe‚Äù option.`);
      else base.push(`You‚Äôre well above the rough cutoff ‚Äî you likely have many options in this area.`);

      // Inject profession-specific ‚Äúwhy‚Äù but keep it different by adding score context + salary bias context
      const salaryLine = {
        self: "You picked a lower-cost circumstance, so the shortlist leans toward faster-entry roles too.",
        couple: "You picked shared/couple, so the shortlist balances stability and growth.",
        family: "You picked family costs, so higher-paying paths get extra weight.",
        growth: "You picked high-growth, so ambitious earning tracks get extra weight."
      }[state.salary];

      const custom = (p.why || []).slice(0,2);
      return [...custom, ...base, salaryLine].slice(0,4);
    }

    function dayToDayBullets(p){
      // lightweight but varied
      const bullets = [];
      if (p.ps === "people") bullets.push("You‚Äôll spend a lot of time communicating, coordinating, or helping people.");
      else bullets.push("You‚Äôll spend a lot of time analysing systems, tools, data, or processes.");

      if (p.da === "desk") bullets.push("Mostly desk-based work (planning, documentation, analysis).");
      else bullets.push("Active work with movement, practical tasks, or on-site duties.");

      if (p.io === "outdoor") bullets.push("Some work happens outside or on-site rather than only in an office.");
      else bullets.push("Mostly indoor environments (office, clinic, classroom, workshop).");

      // category flavor
      const cat = p.cat;
      if (cat === "Health") bullets.push("Accuracy and responsibility matter; training/registration can apply.");
      else if (cat === "Law") bullets.push("Reading/writing and careful reasoning are central.");
      else if (cat === "Tech") bullets.push("Continuous learning is normal; projects prove skill.");
      else if (cat === "Trades") bullets.push("Hands-on skill + safety rules are key; licensing may apply.");
      else if (cat === "Hospitality") bullets.push("Fast pace and teamwork matter; shifts are common.");
      else bullets.push("Progression usually comes from experience + specialisation.");

      return bullets.slice(0,4);
    }

    function pickUniqueStart(p){
      // Ensure different steps per category
      const steps = [];
      if (p.cat === "Tech"){
        steps.push("Build a tiny portfolio: 1 app or 1 analysis project you can show.");
        steps.push("Learn one core skill deeply (JS/Python/SQL/networking depending on role).");
        steps.push("Apply for internships / entry roles; keep iterating projects weekly.");
      } else if (p.cat === "Trades"){
        steps.push("Find an apprenticeship/traineeship pathway (most common route).");
        steps.push("Get basic tickets: white card + safety + reliability references.");
        steps.push("Ask tradespeople about the day-to-day before committing.");
      } else if (p.cat === "Health"){
        steps.push("Check prerequisites and accredited pathways (registration often applies).");
        steps.push("Volunteer or part-time in care/support settings to test fit.");
        steps.push("Build study habits early (science/communication depending on role).");
      } else if (p.cat === "Law"){
        steps.push("Improve writing and logical reasoning (debate, essays, mock trial).");
        steps.push("Research uni cutoffs and alternative pathways (double degrees, later transfer).");
        steps.push("Try admin/support roles to understand legal workplaces.");
      } else if (p.cat === "Education"){
        steps.push("Try tutoring/mentoring to test if teaching fits you.");
        steps.push("Research accredited teaching pathways + placement requirements.");
        steps.push("Pick a subject strength area (math, languages, science, humanities).");
      } else if (p.cat === "Hospitality"){
        steps.push("Get any required certificates (RSA/food handling if needed).");
        steps.push("Start part-time to build speed, teamwork, and customer skills.");
        steps.push("Decide if you want progression (chef/manager) and plan training.");
      } else {
        steps.push(...(p.start || []).slice(0,3));
      }
      // add profession-specific if available, but keep variety
      if (p.start && p.start.length){
        for (const s of p.start){
          if (steps.length >= 4) break;
          if (!steps.includes(s)) steps.push(s);
        }
      }
      return steps.slice(0,4);
    }

    function escapeHtml(s){
      return String(s)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;");
    }

    // ---------- Profession dropdown ----------
    function iconForCat(cat){
      // simple emoji-ish icons via SVG path swap; using one generic badge for now
      return `
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M12 2l3 6 7 .8-5 4.3 1.6 7-6.6-3.7L5.4 20l1.6-7L2 8.8 9 8l3-6z" stroke="#0f172a" stroke-width="1.4"/>
        </svg>
      `;
    }

    let dropIndex = 0;
    let filteredList = [];

    function openDrop(){
      $("dropPanel").classList.add("open");
    }
    function closeDrop(){
      $("dropPanel").classList.remove("open");
    }

    function renderDropList(){
      const q = $("professionInput").value.trim().toLowerCase();
      const eligible = PROFESSIONS.filter(isEligibleByScore);

      filteredList = eligible
        .filter(p => !q || p.name.toLowerCase().includes(q) || p.cat.toLowerCase().includes(q) || p.tags.join(" ").toLowerCase().includes(q))
        .slice(0, 200); // keep fast

      dropIndex = 0;

      const list = $("dropList");
      list.innerHTML = "";

      if (filteredList.length === 0){
        const empty = document.createElement("div");
        empty.className = "row";
        empty.style.cursor = "default";
        empty.innerHTML = `
          <div class="rowIcon">${iconForCat("Other")}</div>
          <div class="rowMain">
            <div class="name">No match in eligible list</div>
            <div class="meta">Try a different spelling or increase your score</div>
          </div>
        `;
        list.appendChild(empty);
        return;
      }

      filteredList.forEach((p, i) => {
        const row = document.createElement("div");
        row.className = "row" + (i === 0 ? " active" : "");
        row.innerHTML = `
          <div class="rowIcon">${iconForCat(p.cat)}</div>
          <div class="rowMain">
            <div class="name">${escapeHtml(p.name)}</div>
            <div class="meta">${escapeHtml(p.cat)} ‚Ä¢ ${escapeHtml(p.tags.slice(0,3).join(" ‚Ä¢ "))}</div>
          </div>
        `;
        row.addEventListener("mousedown", (e) => {
          // mousedown so it selects before blur closes panel
          e.preventDefault();
          selectProfession(p);
          closeDrop();
          runSearch(true);
        });
        list.appendChild(row);
      });
    }

    function highlightRow(){
      const rows = $("dropList").querySelectorAll(".row");
      rows.forEach((r, i) => r.classList.toggle("active", i === dropIndex));
      const active = rows[dropIndex];
      if (active) active.scrollIntoView({block:"nearest"});
    }

    function selectProfession(p){
      state.selectedProfession = p;
      $("professionInput").value = p.name;
      $("professionSub").textContent = `Selected: ${p.cat} ‚Ä¢ ${p.tags.slice(0,3).join(" ‚Ä¢ ")}`;
      updateCTA();
    }

    function clearProfession(){
      state.selectedProfession = null;
      $("professionInput").value = "";
      $("professionSub").textContent = "Explore mode: leave blank to see options for your score.";
      updateCTA();
    }

    // ---------- CTA: score-first ----------
    function updateCTA(){
      const modeWord = (state.mode === "GPA") ? "GPA" : "ATAR";
      const p = state.selectedProfession?.name;

      const main = p ? `Show paths from ${p}` : `Show careers for my ${modeWord}`;
      const sub  = p ? `Related options filtered by your ${modeWord}` : `Explore first, then refine`;

      $("ctaText").textContent = main;
      $("ctaSub").textContent = sub;
    }

    // ---------- Filters ----------
    function setFilter(group, value){
      state.filters[group] = value;

      // update UI: only one per group is "on"
      const pills = document.querySelectorAll(`.filterPill[data-group="${group}"]`);
      pills.forEach(p => p.classList.toggle("on", p.dataset.value === value));
    }

    // ---------- Search / Auto-run ----------
    function runSearch(scrollToResults){
      // Validate score input
      const v = parseScore($("scoreInput").value);
      if (v === null){
        // do nothing if invalid
        return;
      }
      state.score = v;

      // normalize display
      if (state.mode === "ATAR") $("scoreInput").value = state.score.toFixed(2);
      else $("scoreInput").value = state.score.toFixed(0);

      renderDropList(); // keep dropdown eligibility accurate
      renderResults();
      updateCTA();

      if (scrollToResults){
        window.scrollTo({top: document.body.scrollHeight, behavior:"smooth"});
      }
    }

    let autoTimer = null;
    function autoRun(){
      clearTimeout(autoTimer);
      autoTimer = setTimeout(()=> runSearch(false), 350);
    }

    // ---------- Mode modal ----------
    function showModeModal(){
      $("modeModal").classList.add("show");
    }
    function hideModeModal(){
      $("modeModal").classList.remove("show");
    }
    function setMode(mode){
      state.mode = mode;

      const info = labelForMode();
      $("scoreLabel").textContent = info.label;
      $("modeText").textContent = "Mode: " + mode;

      // adjust score format
      const v = parseScore($("scoreInput").value) ?? (mode === "ATAR" ? 70.00 : 70);
      state.score = v;
      if (mode === "ATAR") $("scoreInput").value = state.score.toFixed(2);
      else $("scoreInput").value = state.score.toFixed(0);

      updateCTA();
      renderDropList();
      renderResults();
    }

    // ---------- Wire up ----------
    // Start modal if no mode set
    showModeModal();

    document.querySelectorAll(".modeCard").forEach(el => {
      el.addEventListener("click", () => {
        setMode(el.dataset.mode);
        hideModeModal();
      });
    });

    $("salarySelect").addEventListener("change", () => {
      state.salary = $("salarySelect").value;
      autoRun();
    });

    $("scoreInput").addEventListener("input", autoRun);

    $("searchBtn").addEventListener("click", () => runSearch(true));

    $("resetBtn").addEventListener("click", () => {
      state.salary = "couple";
      $("salarySelect").value = "couple";

      // reset filters
      setFilter("study","any");
      setFilter("ps","any");
      setFilter("da","any");
      setFilter("io","any");

      // clear profession
      clearProfession();

      // reset score
      state.score = (state.mode === "ATAR") ? 70.00 : 70;
      $("scoreInput").value = (state.mode === "ATAR") ? state.score.toFixed(2) : state.score.toFixed(0);

      runSearch(false);
      window.scrollTo({top:0, behavior:"smooth"});
    });

    // filter pills click
    $("filters").addEventListener("click", (e) => {
      const pill = e.target.closest(".filterPill");
      if (!pill) return;
      setFilter(pill.dataset.group, pill.dataset.value);
      autoRun();
    });

    // dropdown open/close + keyboard
    $("professionInput").addEventListener("focus", () => {
      openDrop();
      renderDropList();
    });

    $("professionInput").addEventListener("input", () => {
      // If user types something that isn't the selected profession, clear selection
      if (state.selectedProfession && $("professionInput").value.trim() !== state.selectedProfession.name){
        state.selectedProfession = null;
        $("professionSub").textContent = "Explore mode: leave blank to see options for your score.";
      }
      openDrop();
      renderDropList();
      updateCTA();
    });

    document.addEventListener("click", (e) => {
      const inside = e.target.closest(".dropdown") || e.target.closest(".dropPanel");
      if (!inside){
        closeDrop();
      }
    });

    $("professionInput").addEventListener("keydown", (e) => {
      if (!$("dropPanel").classList.contains("open")) return;

      if (e.key === "ArrowDown"){
        e.preventDefault();
        dropIndex = Math.min(dropIndex + 1, filteredList.length - 1);
        highlightRow();
      }
      if (e.key === "ArrowUp"){
        e.preventDefault();
        dropIndex = Math.max(dropIndex - 1, 0);
        highlightRow();
      }
      if (e.key === "Enter"){
        e.preventDefault();
        const pick = filteredList[dropIndex];
        if (pick){
          selectProfession(pick);
          closeDrop();
          runSearch(true);
        }
      }
      if (e.key === "Escape"){
        closeDrop();
      }
    });

    // Initial render after mode selection (but keep empty until user picks mode)
    function safeInit(){
      updateCTA();
      $("eligibleChip").innerHTML = `<span class="dot2"></span><strong>Eligible in list:</strong> 0 / ${PROFESSIONS.length}`;
      $("results").innerHTML = `
        <div class="card" style="cursor:default;">
          <div class="cardTitle">Choose ATAR or GPA to start</div>
          <div class="tags">
            <span class="tag">Score-first</span>
            <span class="tag">Explore mode</span>
            <span class="tag">Real list</span>
          </div>
          <ul class="bullets">
            <li>Pick a mode, enter your score, and you‚Äôll immediately see realistic options.</li>
            <li>Optional: search a profession from the list to get ‚Äúrelated paths‚Äù.</li>
          </ul>
        </div>
      `;
    }
    safeInit();
  </script>
</body>
</html>
